/*! For license information please see files_sharing-files_sharing_tab.js.LICENSE.txt */
(()=>{"use strict";var e,i,s,a={22509:(e,i,s)=>{var a=s(20144),n=s(31352),r=s(1794),o=s(79753),h=s(75925),l=s.n(h),d=s(4820),c=s(79954),p=s(42515);class u{constructor(){this._capabilities=(0,p.getCapabilities)()}get defaultPermissions(){var t;return null===(t=this._capabilities.files_sharing)||void 0===t?void 0:t.default_permissions}get isPublicUploadEnabled(){var t;return null===(t=this._capabilities.files_sharing)||void 0===t?void 0:t.public.upload}get isShareWithLinkAllowed(){return document.getElementById("allowShareWithLink")&&"yes"===document.getElementById("allowShareWithLink").value}get federatedShareDocLink(){return OC.appConfig.core.federatedCloudShareDoc}get defaultExpirationDate(){return this.isDefaultExpireDateEnabled?new Date((new Date).setDate((new Date).getDate()+this.defaultExpireDate)):null}get defaultInternalExpirationDate(){return this.isDefaultInternalExpireDateEnabled?new Date((new Date).setDate((new Date).getDate()+this.defaultInternalExpireDate)):null}get defaultRemoteExpirationDateString(){return this.isDefaultRemoteExpireDateEnabled?new Date((new Date).setDate((new Date).getDate()+this.defaultRemoteExpireDate)):null}get enforcePasswordForPublicLink(){return!0===OC.appConfig.core.enforcePasswordForPublicLink}get enableLinkPasswordByDefault(){return!0===OC.appConfig.core.enableLinkPasswordByDefault}get isDefaultExpireDateEnforced(){return!0===OC.appConfig.core.defaultExpireDateEnforced}get isDefaultExpireDateEnabled(){return!0===OC.appConfig.core.defaultExpireDateEnabled}get isDefaultInternalExpireDateEnforced(){return!0===OC.appConfig.core.defaultInternalExpireDateEnforced}get isDefaultRemoteExpireDateEnforced(){return!0===OC.appConfig.core.defaultRemoteExpireDateEnforced}get isDefaultInternalExpireDateEnabled(){return!0===OC.appConfig.core.defaultInternalExpireDateEnabled}get isDefaultRemoteExpireDateEnabled(){return!0===OC.appConfig.core.defaultRemoteExpireDateEnabled}get isRemoteShareAllowed(){return!0===OC.appConfig.core.remoteShareAllowed}get isMailShareAllowed(){var t,e,i,s,a;return void 0!==(null===(t=this._capabilities)||void 0===t||null===(e=t.files_sharing)||void 0===e?void 0:e.sharebymail)&&!0===(null===(i=this._capabilities)||void 0===i||null===(s=i.files_sharing)||void 0===s||null===(a=s.public)||void 0===a?void 0:a.enabled)}get defaultExpireDate(){return OC.appConfig.core.defaultExpireDate}get defaultInternalExpireDate(){return OC.appConfig.core.defaultInternalExpireDate}get defaultRemoteExpireDate(){return OC.appConfig.core.defaultRemoteExpireDate}get isResharingAllowed(){return!0===OC.appConfig.core.resharingAllowed}get isPasswordForMailSharesRequired(){return void 0!==this._capabilities.files_sharing.sharebymail&&this._capabilities.files_sharing.sharebymail.password.enforced}get shouldAlwaysShowUnique(){var t,e;return!0===(null===(t=this._capabilities.files_sharing)||void 0===t||null===(e=t.sharee)||void 0===e?void 0:e.always_show_unique)}get allowGroupSharing(){return!0===OC.appConfig.core.allowGroupSharing}get maxAutocompleteResults(){return parseInt(OC.config["sharing.maxAutocompleteResults"],10)||25}get minSearchStringLength(){return parseInt(OC.config["sharing.minSearchStringLength"],10)||0}get passwordPolicy(){return this._capabilities.password_policy?this._capabilities.password_policy:{}}}var A=s(41922),g=s(25108);class f{constructor(t){var e,i,s,a;if(i=this,a=void 0,(s=function(t){var e=function(t,e){if("object"!=typeof t||null===t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var s=i.call(t,"string");if("object"!=typeof s)return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==typeof e?e:String(e)}(s="_share"))in i?Object.defineProperty(i,s,{value:a,enumerable:!0,configurable:!0,writable:!0}):i[s]=a,t.ocs&&t.ocs.data&&t.ocs.data[0]&&(t=t.ocs.data[0]),t.hide_download=!!t.hide_download,t.mail_send=!!t.mail_send,t.attributes)try{t.attributes=JSON.parse(t.attributes)}catch(e){g.warn('Could not parse share attributes returned by server: "'+t.attributes+'"')}t.attributes=null!==(e=t.attributes)&&void 0!==e?e:[],this._share=t}get state(){return this._share}get id(){return this._share.id}get type(){return this._share.share_type}get permissions(){return this._share.permissions}get attributes(){return this._share.attributes}set permissions(t){this._share.permissions=t}get owner(){return this._share.uid_owner}get ownerDisplayName(){return this._share.displayname_owner}get shareWith(){return this._share.share_with}get shareWithDisplayName(){return this._share.share_with_displayname||this._share.share_with}get shareWithDisplayNameUnique(){return this._share.share_with_displayname_unique||this._share.share_with}get shareWithLink(){return this._share.share_with_link}get shareWithAvatar(){return this._share.share_with_avatar}get uidFileOwner(){return this._share.uid_file_owner}get displaynameFileOwner(){return this._share.displayname_file_owner||this._share.uid_file_owner}get createdTime(){return this._share.stime}get expireDate(){return this._share.expiration}set expireDate(t){this._share.expiration=t}get token(){return this._share.token}get note(){return this._share.note}set note(t){this._share.note=t}get label(){return this._share.label}set label(t){this._share.label=t}get mailSend(){return!0===this._share.mail_send}get hideDownload(){return!0===this._share.hide_download}set hideDownload(t){this._share.hide_download=!0===t}get password(){return this._share.password}set password(t){this._share.password=t}get passwordExpirationTime(){return this._share.password_expiration_time}set passwordExpirationTime(t){this._share.password_expiration_time=t}get sendPasswordByTalk(){return this._share.send_password_by_talk}set sendPasswordByTalk(t){this._share.send_password_by_talk=t}get path(){return this._share.path}get itemType(){return this._share.item_type}get mimetype(){return this._share.mimetype}get fileSource(){return this._share.file_source}get fileTarget(){return this._share.file_target}get fileParent(){return this._share.file_parent}get hasReadPermission(){return!!(this.permissions&OC.PERMISSION_READ)}get hasCreatePermission(){return!!(this.permissions&OC.PERMISSION_CREATE)}get hasDeletePermission(){return!!(this.permissions&OC.PERMISSION_DELETE)}get hasUpdatePermission(){return!!(this.permissions&OC.PERMISSION_UPDATE)}get hasSharePermission(){return!!(this.permissions&OC.PERMISSION_SHARE)}get hasDownloadPermission(){for(const t in this._share.attributes){const e=this._share.attributes[t];if("permissions"===e.scope&&"download"===e.key)return e.enabled}return!0}set hasDownloadPermission(t){this.setAttribute("permissions","download",!!t)}setAttribute(t,e,i){const s={scope:t,key:e,enabled:i};for(const t in this._share.attributes){const e=this._share.attributes[t];if(e.scope===s.scope&&e.key===s.key)return void this._share.attributes.splice(t,1,s)}this._share.attributes.push(s)}get canEdit(){return!0===this._share.can_edit}get canDelete(){return!0===this._share.can_delete}get viaFileid(){return this._share.via_fileid}get viaPath(){return this._share.via_path}get parent(){return this._share.parent}get storageId(){return this._share.storage_id}get storage(){return this._share.storage}get itemSource(){return this._share.item_source}get status(){return this._share.status}}const _={data:()=>({SHARE_TYPES:A.D})};var m=s(64024),w=s(76212),E=s.n(w),v=s(12945),C=s.n(v);const y={name:"SharingEntrySimple",components:{NcActions:C()},props:{title:{type:String,default:"",required:!0},subtitle:{type:String,default:""},isUnique:{type:Boolean,default:!0},ariaExpanded:{type:Boolean,default:null}},computed:{ariaExpandedValue(){return null===this.ariaExpanded?this.ariaExpanded:this.ariaExpanded?"true":"false"}}};var S=s(93379),b=s.n(S),x=s(7795),P=s.n(x),T=s(90569),D=s.n(T),k=s(3565),R=s.n(k),I=s(19216),N=s.n(I),O=s(44589),L=s.n(O),Y=s(66452),H={};H.styleTagTransform=L(),H.setAttributes=R(),H.insert=D().bind(null,"head"),H.domAPI=P(),H.insertStyleElement=N(),b()(Y.Z,H),Y.Z&&Y.Z.locals&&Y.Z.locals;var B=s(51900);const U=(0,B.Z)(y,(function(){var t=this,e=t._self._c;return e("li",{staticClass:"sharing-entry"},[t._t("avatar"),t._v(" "),e("div",{staticClass:"sharing-entry__desc"},[e("span",{staticClass:"sharing-entry__title"},[t._v(t._s(t.title))]),t._v(" "),t.subtitle?e("p",[t._v("\n\t\t\t"+t._s(t.subtitle)+"\n\t\t")]):t._e()]),t._v(" "),t.$slots.default?e("NcActions",{ref:"actionsComponent",staticClass:"sharing-entry__actions",attrs:{"menu-align":"right","aria-expanded":t.ariaExpandedValue}},[t._t("default")],2):t._e()],2)}),[],!1,null,"1852ea78",null).exports;var F=s(25108);const q={name:"SharingEntryInternal",components:{NcActionLink:E(),SharingEntrySimple:U},props:{fileInfo:{type:Object,default:()=>{},required:!0}},data:()=>({copied:!1,copySuccess:!1}),computed:{internalLink(){return window.location.protocol+"//"+window.location.host+(0,o.generateUrl)("/f/")+this.fileInfo.id},copyLinkTooltip(){return this.copied?this.copySuccess?"":t("files_sharing","Cannot copy, please copy the link manually"):t("files_sharing","Copy internal link to clipboard")},internalLinkSubtitle(){return"dir"===this.fileInfo.type?t("files_sharing","Only works for users with access to this folder"):t("files_sharing","Only works for users with access to this file")}},methods:{async copyLink(){try{await navigator.clipboard.writeText(this.internalLink),(0,m.s$)(t("files_sharing","Link copied")),this.$refs.shareEntrySimple.$refs.actionsComponent.$el.focus(),this.copySuccess=!0,this.copied=!0}catch(t){this.copySuccess=!1,this.copied=!0,F.error(t)}finally{setTimeout((()=>{this.copySuccess=!1,this.copied=!1}),4e3)}}}};var M=s(2256),W={};W.styleTagTransform=L(),W.setAttributes=R(),W.insert=D().bind(null,"head"),W.domAPI=P(),W.insertStyleElement=N(),b()(M.Z,W),M.Z&&M.Z.locals&&M.Z.locals;const j=(0,B.Z)(q,(function(){var t=this,e=t._self._c;return e("ul",[e("SharingEntrySimple",{ref:"shareEntrySimple",staticClass:"sharing-entry__internal",attrs:{title:t.t("files_sharing","Internal link"),subtitle:t.internalLinkSubtitle},scopedSlots:t._u([{key:"avatar",fn:function(){return[e("div",{staticClass:"avatar-external icon-external-white"})]},proxy:!0}])},[t._v(" "),e("NcActionLink",{attrs:{href:t.internalLink,"aria-label":t.copyLinkTooltip,title:t.copyLinkTooltip,target:"_blank",icon:t.copied&&t.copySuccess?"icon-checkmark-color":"icon-clippy"},on:{click:function(e){return e.preventDefault(),t.copyLink.apply(null,arguments)}}})],1)],1)}),[],!1,null,"71a426be",null).exports;var Z=s(77958),V=s(69183),$=s(20296),G=s.n($),z=s(36456),K=s.n(z),Q=s(25108);const J=new u;async function X(){if(J.passwordPolicy.api&&J.passwordPolicy.api.generate)try{const e=await d.default.get(J.passwordPolicy.api.generate);if(e.data.ocs.data.password)return(0,m.s$)(t("files_sharing","Password created successfully")),e.data.ocs.data.password}catch(e){Q.info("Error generating password from password_policy",e),(0,m.x2)(t("files_sharing","Error generating password from password policy"))}const e=new Uint8Array(10);self.crypto.getRandomValues(e);let i="";for(let t=0;t<e.length;t++)i+="abcdefgijkmnopqrstwxyzABCDEFGHJKLMNPQRSTWXYZ23456789".charAt(.20392156862745098*e[t]);return i}s(35449);var tt=s(25108);const et=(0,o.generateOcsUrl)("apps/files_sharing/api/v1/shares"),it={methods:{async createShare(e){let{path:i,permissions:s,shareType:a,shareWith:n,publicUpload:r,password:o,sendPasswordByTalk:h,expireDate:l,label:c,note:p,attributes:u}=e;try{var A;const t=await d.default.post(et,{path:i,permissions:s,shareType:a,shareWith:n,publicUpload:r,password:o,sendPasswordByTalk:h,expireDate:l,label:c,note:p,attributes:u});if(null==t||null===(A=t.data)||void 0===A||!A.ocs)throw t;const e=new f(t.data.ocs.data);return(0,V.j8)("files_sharing:share:created",{share:e}),e}catch(e){var g,_,m,w;tt.error("Error while creating share",e);const i=null==e||null===(g=e.response)||void 0===g||null===(_=g.data)||void 0===_||null===(m=_.ocs)||void 0===m||null===(w=m.meta)||void 0===w?void 0:w.message;throw OC.Notification.showTemporary(i?t("files_sharing","Error creating the share: {errorMessage}",{errorMessage:i}):t("files_sharing","Error creating the share"),{type:"error"}),e}},async deleteShare(e){try{var i;const t=await d.default.delete(et+"/".concat(e));if(null==t||null===(i=t.data)||void 0===i||!i.ocs)throw t;return(0,V.j8)("files_sharing:share:deleted",{id:e}),!0}catch(e){var s,a,n,r;tt.error("Error while deleting share",e);const i=null==e||null===(s=e.response)||void 0===s||null===(a=s.data)||void 0===a||null===(n=a.ocs)||void 0===n||null===(r=n.meta)||void 0===r?void 0:r.message;throw OC.Notification.showTemporary(i?t("files_sharing","Error deleting the share: {errorMessage}",{errorMessage:i}):t("files_sharing","Error deleting the share"),{type:"error"}),e}},async updateShare(e,i){try{var s;const t=await d.default.put(et+"/".concat(e),i);if((0,V.j8)("files_sharing:share:updated",{id:e}),null!=t&&null!==(s=t.data)&&void 0!==s&&s.ocs)return t.data.ocs.data;throw t}catch(e){if(tt.error("Error while updating share",e),400!==e.response.status){var a,n,r,o;const i=null==e||null===(a=e.response)||void 0===a||null===(n=a.data)||void 0===n||null===(r=n.ocs)||void 0===r||null===(o=r.meta)||void 0===o?void 0:o.message;OC.Notification.showTemporary(i?t("files_sharing","Error updating the share: {errorMessage}",{errorMessage:i}):t("files_sharing","Error updating the share"),{type:"error"})}const i=e.response.data.ocs.meta.message;throw new Error(i)}}}},st={methods:{async openSharingDetails(t){let e={};t.handler?(this.suggestions&&(t.suggestions=this.suggestions,t.fileInfo=this.fileInfo,t.query=this.query),e=await t.handler(t),e=new f(e)):e=this.mapShareRequestToShareObject(t);const i={fileInfo:this.fileInfo,share:e};this.$emit("open-sharing-details",i)},openShareDetailsForCustomSettings(t){t.setCustomPermissions=!0,this.openSharingDetails(t)},mapShareRequestToShareObject(t){if(t.id)return t;const e={attributes:[{enabled:!0,key:"download",scope:"permissions"}],share_type:t.shareType,share_with:t.shareWith,is_no_user:t.isNoUser,user:t.shareWith,share_with_displayname:t.displayName,subtitle:t.subtitle,permissions:t.permissions,expiration:""};return new f(e)}}};var at=s(25108);const nt={name:"SharingInput",components:{NcSelect:K()},mixins:[_,it,st],props:{shares:{type:Array,default:()=>[],required:!0},linkShares:{type:Array,default:()=>[],required:!0},fileInfo:{type:Object,default:()=>{},required:!0},reshare:{type:f,default:null},canReshare:{type:Boolean,required:!0}},data:()=>({config:new u,loading:!1,query:"",recommendations:[],ShareSearch:OCA.Sharing.ShareSearch.state,suggestions:[],value:null}),computed:{externalResults(){return this.ShareSearch.results},inputPlaceholder(){const e=this.config.isRemoteShareAllowed;return this.canReshare?e?t("files_sharing","Name, email, or Federated Cloud ID …"):t("files_sharing","Name or email …"):t("files_sharing","Resharing is not allowed")},isValidQuery(){return this.query&&""!==this.query.trim()&&this.query.length>this.config.minSearchStringLength},options(){return this.isValidQuery?this.suggestions:this.recommendations},noResultText(){return this.loading?t("files_sharing","Searching …"):t("files_sharing","No elements found.")}},mounted(){this.getRecommendations()},methods:{handleOpen(){(0,V.j8)("viewer:trapElements:changed",this.$refs.select.$el)},async asyncFind(t){this.query=t.trim(),this.isValidQuery&&(this.loading=!0,await this.debounceGetSuggestions(t))},async getSuggestions(e){let i=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.loading=!0,!0===OC.getCapabilities().files_sharing.sharee.query_lookup_default&&(i=!0);const s=[this.SHARE_TYPES.SHARE_TYPE_USER,this.SHARE_TYPES.SHARE_TYPE_GROUP,this.SHARE_TYPES.SHARE_TYPE_REMOTE,this.SHARE_TYPES.SHARE_TYPE_REMOTE_GROUP,this.SHARE_TYPES.SHARE_TYPE_CIRCLE,this.SHARE_TYPES.SHARE_TYPE_ROOM,this.SHARE_TYPES.SHARE_TYPE_GUEST,this.SHARE_TYPES.SHARE_TYPE_DECK,this.SHARE_TYPES.SHARE_TYPE_SCIENCEMESH];!0===OC.getCapabilities().files_sharing.public.enabled&&s.push(this.SHARE_TYPES.SHARE_TYPE_EMAIL);let a=null;try{a=await d.default.get((0,o.generateOcsUrl)("apps/files_sharing/api/v1/sharees"),{params:{format:"json",itemType:"dir"===this.fileInfo.type?"folder":"file",search:e,lookup:i,perPage:this.config.maxAutocompleteResults,shareType:s}})}catch(t){return void at.error("Error fetching suggestions",t)}const n=a.data.ocs.data,r=a.data.ocs.data.exact;n.exact=[];const h=Object.values(r).reduce(((t,e)=>t.concat(e)),[]),l=Object.values(n).reduce(((t,e)=>t.concat(e)),[]),c=this.filterOutExistingShares(h).map((t=>this.formatForMultiselect(t))).sort(((t,e)=>t.shareType-e.shareType)),p=this.filterOutExistingShares(l).map((t=>this.formatForMultiselect(t))).sort(((t,e)=>t.shareType-e.shareType)),u=[];n.lookupEnabled&&!i&&u.push({id:"global-lookup",isNoUser:!0,displayName:t("files_sharing","Search globally"),lookup:!0});const A=this.externalResults.filter((t=>!t.condition||t.condition(this))),g=c.concat(p).concat(A).concat(u),f=g.reduce(((t,e)=>e.displayName?(t[e.displayName]||(t[e.displayName]=0),t[e.displayName]++,t):t),{});this.suggestions=g.map((t=>f[t.displayName]>1&&!t.desc?{...t,desc:t.shareWithDisplayNameUnique}:t)),this.loading=!1,at.info("suggestions",this.suggestions)},debounceGetSuggestions:G()((function(){this.getSuggestions(...arguments)}),300),async getRecommendations(){this.loading=!0;let t=null;try{t=await d.default.get((0,o.generateOcsUrl)("apps/files_sharing/api/v1/sharees_recommended"),{params:{format:"json",itemType:this.fileInfo.type}})}catch(t){return void at.error("Error fetching recommendations",t)}const e=this.externalResults.filter((t=>!t.condition||t.condition(this))),i=Object.values(t.data.ocs.data.exact).reduce(((t,e)=>t.concat(e)),[]);this.recommendations=this.filterOutExistingShares(i).map((t=>this.formatForMultiselect(t))).concat(e),this.loading=!1,at.info("recommendations",this.recommendations)},filterOutExistingShares(t){return t.reduce(((t,e)=>{if("object"!=typeof e)return t;try{if(e.value.shareType===this.SHARE_TYPES.SHARE_TYPE_USER){if(e.value.shareWith===(0,Z.ts)().uid)return t;if(this.reshare&&e.value.shareWith===this.reshare.owner)return t}if(e.value.shareType===this.SHARE_TYPES.SHARE_TYPE_EMAIL){if(-1!==this.linkShares.map((t=>t.shareWith)).indexOf(e.value.shareWith.trim()))return t}else{const i=this.shares.reduce(((t,e)=>(t[e.shareWith]=e.type,t)),{}),s=e.value.shareWith.trim();if(s in i&&i[s]===e.value.shareType)return t}t.push(e)}catch{return t}return t}),[])},shareTypeToIcon(e){switch(e){case this.SHARE_TYPES.SHARE_TYPE_GUEST:return{icon:"icon-user",iconTitle:t("files_sharing","Guest")};case this.SHARE_TYPES.SHARE_TYPE_REMOTE_GROUP:case this.SHARE_TYPES.SHARE_TYPE_GROUP:return{icon:"icon-group",iconTitle:t("files_sharing","Group")};case this.SHARE_TYPES.SHARE_TYPE_EMAIL:return{icon:"icon-mail",iconTitle:t("files_sharing","Email")};case this.SHARE_TYPES.SHARE_TYPE_CIRCLE:return{icon:"icon-circle",iconTitle:t("files_sharing","Circle")};case this.SHARE_TYPES.SHARE_TYPE_ROOM:return{icon:"icon-room",iconTitle:t("files_sharing","Talk conversation")};case this.SHARE_TYPES.SHARE_TYPE_DECK:return{icon:"icon-deck",iconTitle:t("files_sharing","Deck board")};case this.SHARE_TYPES.SHARE_TYPE_SCIENCEMESH:return{icon:"icon-sciencemesh",iconTitle:t("files_sharing","ScienceMesh")};default:return{}}},formatForMultiselect(e){let i;var s;if(e.value.shareType===this.SHARE_TYPES.SHARE_TYPE_USER&&this.config.shouldAlwaysShowUnique)i=null!==(s=e.shareWithDisplayNameUnique)&&void 0!==s?s:"";else if(e.value.shareType!==this.SHARE_TYPES.SHARE_TYPE_REMOTE&&e.value.shareType!==this.SHARE_TYPES.SHARE_TYPE_REMOTE_GROUP||!e.value.server)if(e.value.shareType===this.SHARE_TYPES.SHARE_TYPE_EMAIL)i=e.value.shareWith;else{var a;i=null!==(a=e.shareWithDescription)&&void 0!==a?a:""}else i=t("files_sharing","on {server}",{server:e.value.server});return{shareWith:e.value.shareWith,shareType:e.value.shareType,user:e.uuid||e.value.shareWith,isNoUser:e.value.shareType!==this.SHARE_TYPES.SHARE_TYPE_USER,displayName:e.name||e.label,subtitle:i,shareWithDisplayNameUnique:e.shareWithDisplayNameUnique||"",...this.shareTypeToIcon(e.value.shareType)}},async addShare(t){if(this.value=null,t.lookup)return await this.getSuggestions(this.query,!0),this.$nextTick((()=>{this.$refs.select.$children[0].open=!0})),!0;if(t.handler){const e=await t.handler(this);return this.$emit("add:share",new f(e)),!0}this.loading=!0,at.debug("Adding a new share from the input for",t);try{let e=null;this.config.enforcePasswordForPublicLink&&t.shareType===this.SHARE_TYPES.SHARE_TYPE_EMAIL&&(e=await X());const i=(this.fileInfo.path+"/"+this.fileInfo.name).replace("//","/"),s=await this.createShare({path:i,shareType:t.shareType,shareWith:t.shareWith,password:e,permissions:this.fileInfo.sharePermissions&OC.getCapabilities().files_sharing.default_permissions,attributes:JSON.stringify(this.fileInfo.shareAttributes)});e?(s.newPassword=e,(await new Promise((t=>{this.$emit("add:share",s,t)}))).open=!0):this.$emit("add:share",s),await this.getRecommendations()}catch(e){this.$nextTick((()=>{this.$refs.select.$children[0].open=!0})),this.query=t.shareWith,at.error("Error while adding new share",e)}finally{this.loading=!1}}}};var rt=s(24764),ot={};ot.styleTagTransform=L(),ot.setAttributes=R(),ot.insert=D().bind(null,"head"),ot.domAPI=P(),ot.insertStyleElement=N(),b()(rt.Z,ot),rt.Z&&rt.Z.locals&&rt.Z.locals;const ht=(0,B.Z)(nt,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"sharing-search"},[e("label",{attrs:{for:"sharing-search-input"}},[t._v(t._s(t.t("files_sharing","Search for share recipients")))]),t._v(" "),e("NcSelect",{ref:"select",staticClass:"sharing-search__input",attrs:{"input-id":"sharing-search-input",disabled:!t.canReshare,loading:t.loading,filterable:!1,placeholder:t.inputPlaceholder,"clear-search-on-blur":()=>!1,"user-select":!0,options:t.options},on:{open:t.handleOpen,search:t.asyncFind,"option:selected":t.openSharingDetails},scopedSlots:t._u([{key:"no-options",fn:function(e){let{search:i}=e;return[t._v("\n\t\t\t"+t._s(i?t.noResultText:t.t("files_sharing","No recommendations. Start typing."))+"\n\t\t")]}}]),model:{value:t.value,callback:function(e){t.value=e},expression:"value"}})],1)}),[],!1,null,null,null).exports;var lt=s(45400),dt=s.n(lt),ct=s(65358),pt=s(1162),ut=s.n(pt),At=s(25746);const gt={NONE:0,READ:1,UPDATE:2,CREATE:4,DELETE:8,SHARE:16},ft={READ_ONLY:gt.READ,UPLOAD_AND_UPDATE:gt.READ|gt.UPDATE|gt.CREATE|gt.DELETE,FILE_DROP:gt.CREATE,ALL:gt.UPDATE|gt.CREATE|gt.READ|gt.DELETE|gt.SHARE,ALL_FILE:gt.UPDATE|gt.READ|gt.SHARE};var _t=s(25108);const mt={mixins:[it,_],props:{fileInfo:{type:Object,default:()=>{},required:!0},share:{type:f,default:null},isUnique:{type:Boolean,default:!0}},data(){var t;return{config:new u,errors:{},loading:!1,saving:!1,open:!1,updateQueue:new At.Z({concurrency:1}),reactiveState:null===(t=this.share)||void 0===t?void 0:t.state}},computed:{hasNote:{get(){return""!==this.share.note},set(t){this.share.note=t?null:""}},dateTomorrow:()=>new Date((new Date).setDate((new Date).getDate()+1)),lang(){const t=window.dayNamesShort?window.dayNamesShort:["Sun.","Mon.","Tue.","Wed.","Thu.","Fri.","Sat."],e=window.monthNamesShort?window.monthNamesShort:["Jan.","Feb.","Mar.","Apr.","May.","Jun.","Jul.","Aug.","Sep.","Oct.","Nov.","Dec."];return{formatLocale:{firstDayOfWeek:window.firstDay?window.firstDay:0,monthsShort:e,weekdaysMin:t,weekdaysShort:t},monthFormat:"MMM"}},isFolder(){return"dir"===this.fileInfo.type},isPublicShare(){var t;const e=null!==(t=this.share.shareType)&&void 0!==t?t:this.share.type;return[this.SHARE_TYPES.SHARE_TYPE_LINK,this.SHARE_TYPES.SHARE_TYPE_EMAIL].includes(e)},isRemoteShare(){return this.share.type===this.SHARE_TYPES.SHARE_TYPE_REMOTE_GROUP||this.share.type===this.SHARE_TYPES.SHARE_TYPE_REMOTE},isShareOwner(){return this.share&&this.share.owner===(0,Z.ts)().uid},isExpiryDateEnforced(){return this.isPublicShare?this.config.isDefaultExpireDateEnforced:this.isRemoteShare?this.config.isDefaultRemoteExpireDateEnforced:this.config.isDefaultInternalExpireDateEnforced},hasCustomPermissions(){return![ft.ALL,ft.READ_ONLY,ft.FILE_DROP].includes(this.share.permissions)},maxExpirationDateEnforced(){return this.isExpiryDateEnforced?this.isPublicShare?this.config.defaultExpirationDate:this.isRemoteShare?this.config.defaultRemoteExpirationDateString:this.config.defaultInternalExpirationDate:null}},methods:{checkShare:t=>(!t.password||"string"==typeof t.password&&""!==t.password.trim())&&!(t.expirationDate&&!t.expirationDate.isValid()),parseDateString(t){var e;if(t)return new Date(null===(e=t.match(/([0-9]{4}-[0-9]{2}-[0-9]{2})/i))||void 0===e?void 0:e.pop())},formatDateToString:t=>new Date(Date.UTC(t.getFullYear(),t.getMonth(),t.getDate())).toISOString().split("T")[0],onExpirationChange:G()((function(t){this.share.expireDate=this.formatDateToString(new Date(t))}),500),onExpirationDisable(){this.share.expireDate=""},onNoteChange(t){this.$set(this.share,"newNote",t.trim())},onNoteSubmit(){this.share.newNote&&(this.share.note=this.share.newNote,this.$delete(this.share,"newNote"),this.queueUpdate("note"))},async onDelete(){try{this.loading=!0,this.open=!1,await this.deleteShare(this.share.id),_t.debug("Share deleted",this.share.id);const e="file"===this.share.itemType?t("files_sharing",'File "{path}" has been unshared',{path:this.share.path}):t("files_sharing",'Folder "{path}" has been unshared',{path:this.share.path});(0,m.s$)(e),this.$emit("remove:share",this.share)}catch(t){this.open=!0}finally{this.loading=!1}},queueUpdate(){for(var e=arguments.length,i=new Array(e),s=0;s<e;s++)i[s]=arguments[s];if(0!==i.length){if(this.share.id){const e={};return i.forEach((t=>{"object"==typeof this.share[t]?e[t]=JSON.stringify(this.share[t]):e[t]=this.share[t].toString()})),void this.updateQueue.add((async()=>{this.saving=!0,this.errors={};try{const s=await this.updateShare(this.share.id,e);i.indexOf("password")>=0&&(this.$delete(this.share,"newPassword"),this.share.passwordExpirationTime=s.password_expiration_time),this.$delete(this.errors,i[0]),(0,m.s$)(t("files_sharing","Share {propertyName} saved",{propertyName:i[0]}))}catch({message:e}){e&&""!==e&&(this.onSyncError(i[0],e),(0,m.x2)(t("files_sharing",e)))}finally{this.saving=!1}}))}_t.debug("Updated local share",this.share)}},onSyncError(t,e){switch(this.open=!0,t){case"password":case"pending":case"expireDate":case"label":case"note":{this.$set(this.errors,t,e);let i=this.$refs[t];if(i){i.$el&&(i=i.$el);const t=i.querySelector(".focusable");t&&t.focus()}break}case"sendPasswordByTalk":this.$set(this.errors,t,e),this.share.sendPasswordByTalk=!this.share.sendPasswordByTalk}},debounceQueueUpdate:G()((function(t){this.queueUpdate(t)}),500)}},wt={name:"SharingEntryInherited",components:{NcActionButton:dt(),NcActionLink:E(),NcActionText:ut(),NcAvatar:l(),SharingEntrySimple:U},mixins:[mt],props:{share:{type:f,required:!0}},computed:{viaFileTargetUrl(){return(0,o.generateUrl)("/f/{fileid}",{fileid:this.share.viaFileid})},viaFolderName(){return(0,ct.EZ)(this.share.viaPath)}}};var Et=s(72021),vt={};vt.styleTagTransform=L(),vt.setAttributes=R(),vt.insert=D().bind(null,"head"),vt.domAPI=P(),vt.insertStyleElement=N(),b()(Et.Z,vt),Et.Z&&Et.Z.locals&&Et.Z.locals;const Ct=(0,B.Z)(wt,(function(){var t=this,e=t._self._c;return e("SharingEntrySimple",{key:t.share.id,staticClass:"sharing-entry__inherited",attrs:{title:t.share.shareWithDisplayName},scopedSlots:t._u([{key:"avatar",fn:function(){return[e("NcAvatar",{staticClass:"sharing-entry__avatar",attrs:{user:t.share.shareWith,"display-name":t.share.shareWithDisplayName}})]},proxy:!0}])},[t._v(" "),e("NcActionText",{attrs:{icon:"icon-user"}},[t._v("\n\t\t"+t._s(t.t("files_sharing","Added by {initiator}",{initiator:t.share.ownerDisplayName}))+"\n\t")]),t._v(" "),t.share.viaPath&&t.share.viaFileid?e("NcActionLink",{attrs:{icon:"icon-folder",href:t.viaFileTargetUrl}},[t._v("\n\t\t"+t._s(t.t("files_sharing","Via “{folder}”",{folder:t.viaFolderName}))+"\n\t")]):t._e(),t._v(" "),t.share.canDelete?e("NcActionButton",{attrs:{icon:"icon-close"},on:{click:function(e){return e.preventDefault(),t.onDelete.apply(null,arguments)}}},[t._v("\n\t\t"+t._s(t.t("files_sharing","Unshare"))+"\n\t")]):t._e()],1)}),[],!1,null,"283ca89e",null).exports;var yt=s(25108);const St={name:"SharingInherited",components:{NcActionButton:dt(),SharingEntryInherited:Ct,SharingEntrySimple:U},props:{fileInfo:{type:Object,default:()=>{},required:!0}},data:()=>({loaded:!1,loading:!1,showInheritedShares:!1,shares:[]}),computed:{showInheritedSharesIcon(){return this.loading?"icon-loading-small":this.showInheritedShares?"icon-triangle-n":"icon-triangle-s"},mainTitle:()=>t("files_sharing","Others with access"),subTitle(){return this.showInheritedShares&&0===this.shares.length?t("files_sharing","No other users with access found"):""},toggleTooltip(){return"dir"===this.fileInfo.type?t("files_sharing","Toggle list of others with access to this directory"):t("files_sharing","Toggle list of others with access to this file")},fullPath(){return"".concat(this.fileInfo.path,"/").concat(this.fileInfo.name).replace("//","/")}},watch:{fileInfo(){this.resetState()}},methods:{toggleInheritedShares(){this.showInheritedShares=!this.showInheritedShares,this.showInheritedShares?this.fetchInheritedShares():this.resetState()},async fetchInheritedShares(){this.loading=!0;try{const t=(0,o.generateOcsUrl)("apps/files_sharing/api/v1/shares/inherited?format=json&path={path}",{path:this.fullPath}),e=await d.default.get(t);this.shares=e.data.ocs.data.map((t=>new f(t))).sort(((t,e)=>e.createdTime-t.createdTime)),yt.info(this.shares),this.loaded=!0}catch(e){OC.Notification.showTemporary(t("files_sharing","Unable to fetch inherited shares"),{type:"error"})}finally{this.loading=!1}},resetState(){this.loaded=!1,this.loading=!1,this.showInheritedShares=!1,this.shares=[]},removeShare(t){const e=this.shares.findIndex((e=>e===t));this.shares.splice(e,1)}}};var bt=s(84772),xt={};xt.styleTagTransform=L(),xt.setAttributes=R(),xt.insert=D().bind(null,"head"),xt.domAPI=P(),xt.insertStyleElement=N(),b()(bt.Z,xt),bt.Z&&bt.Z.locals&&bt.Z.locals;const Pt=(0,B.Z)(St,(function(){var t=this,e=t._self._c;return e("ul",{attrs:{id:"sharing-inherited-shares"}},[e("SharingEntrySimple",{staticClass:"sharing-entry__inherited",attrs:{title:t.mainTitle,subtitle:t.subTitle,"aria-expanded":t.showInheritedShares},scopedSlots:t._u([{key:"avatar",fn:function(){return[e("div",{staticClass:"avatar-shared icon-more-white"})]},proxy:!0}])},[t._v(" "),e("NcActionButton",{attrs:{icon:t.showInheritedSharesIcon,"aria-label":t.toggleTooltip,title:t.toggleTooltip},on:{click:function(e){return e.preventDefault(),e.stopPropagation(),t.toggleInheritedShares.apply(null,arguments)}}})],1),t._v(" "),t._l(t.shares,(function(i){return e("SharingEntryInherited",{key:i.id,attrs:{"file-info":t.fileInfo,share:i},on:{"remove:share":t.removeShare}})}))],2)}),[],!1,null,"05b67dc8",null).exports;var Tt=s(79570),Dt=s.n(Tt),kt=s(875),Rt=s.n(kt),It=s(55976),Nt=s(3641),Ot=s(15303);const Lt={components:{DropdownIcon:Nt.Z},mixins:[mt,st,_],props:{share:{type:Object,required:!0},toggle:{type:Boolean,default:!1}},data(){return{selectedOption:"",showDropdown:this.toggle,focusTrap:null}},computed:{canViewText:()=>t("files_sharing","View only"),canEditText:()=>t("files_sharing","Can edit"),fileDropText:()=>t("files_sharing","File drop"),customPermissionsText:()=>t("files_sharing","Custom permissions"),preSelectedOption(){return(this.share.permissions&~gt.SHARE)===ft.READ_ONLY?this.canViewText:this.share.permissions===ft.ALL||this.share.permissions===ft.ALL_FILE?this.canEditText:(this.share.permissions&~gt.SHARE)===ft.FILE_DROP?this.fileDropText:this.customPermissionsText},options(){const t=[this.canViewText,this.canEditText];return this.supportsFileDrop&&t.push(this.fileDropText),t.push(this.customPermissionsText),t},supportsFileDrop(){if(this.isFolder&&this.config.isPublicUploadEnabled){var t;const e=null!==(t=this.share.type)&&void 0!==t?t:this.share.shareType;return[this.SHARE_TYPES.SHARE_TYPE_LINK,this.SHARE_TYPES.SHARE_TYPE_EMAIL].includes(e)}return!1},dropDownPermissionValue(){switch(this.selectedOption){case this.canEditText:return this.isFolder?ft.ALL:ft.ALL_FILE;case this.fileDropText:return ft.FILE_DROP;case this.customPermissionsText:return"custom";case this.canViewText:default:return ft.READ_ONLY}},dropdownId:()=>"dropdown-".concat(Math.random().toString(36).substr(2,9))},watch:{toggle(t){this.showDropdown=t}},mounted(){this.initializeComponent(),window.addEventListener("click",this.handleClickOutside)},beforeDestroy(){window.removeEventListener("click",this.handleClickOutside)},methods:{toggleDropdown(){this.showDropdown=!this.showDropdown,this.showDropdown?this.$nextTick((()=>{this.useFocusTrap()})):this.clearFocusTrap()},closeDropdown(){this.clearFocusTrap(),this.showDropdown=!1},selectOption(t){this.selectedOption=t,t===this.customPermissionsText?this.$emit("open-sharing-details"):(this.share.permissions=this.dropDownPermissionValue,this.queueUpdate("permissions")),this.showDropdown=!1},initializeComponent(){this.selectedOption=this.preSelectedOption},handleClickOutside(t){const e=this.$refs.quickShareDropdownContainer;e&&!e.contains(t.target)&&(this.showDropdown=!1)},useFocusTrap(){Object.assign(window,{_nc_focus_trap:window._nc_focus_trap||[]});const t=this.$refs.quickShareDropdown;this.focusTrap=(0,Ot.createFocusTrap)(t,{allowOutsideClick:!0,trapStack:window._nc_focus_trap}),this.focusTrap.activate()},clearFocusTrap(){var t;null===(t=this.focusTrap)||void 0===t||t.deactivate(),this.focusTrap=null},shiftFocusForward(){let t=document.activeElement.nextElementSibling;t||(t=this.$refs.quickShareDropdown.firstElementChild),t.focus()},shiftFocusBackward(){let t=document.activeElement.previousElementSibling;t||(t=this.$refs.quickShareDropdown.lastElementChild),t.focus()},handleArrowUp(){this.shiftFocusBackward()},handleArrowDown(){this.shiftFocusForward()}}},Yt=Lt;var Ht=s(96021),Bt={};Bt.styleTagTransform=L(),Bt.setAttributes=R(),Bt.insert=D().bind(null,"head"),Bt.domAPI=P(),Bt.insertStyleElement=N(),b()(Ht.Z,Bt),Ht.Z&&Ht.Z.locals&&Ht.Z.locals;const Ut=(0,B.Z)(Yt,(function(){var t=this,e=t._self._c;return e("div",{ref:"quickShareDropdownContainer",class:{active:t.showDropdown,"share-select":!0}},[e("span",{staticClass:"trigger-text",attrs:{id:t.dropdownId,"aria-expanded":t.showDropdown,"aria-haspopup":!0,"aria-label":"Quick share options dropdown"},on:{click:t.toggleDropdown}},[t._v("\n\t\t"+t._s(t.selectedOption)+"\n\t\t"),e("DropdownIcon",{attrs:{size:15}})],1),t._v(" "),t.showDropdown?e("div",{ref:"quickShareDropdown",staticClass:"share-select-dropdown",attrs:{"aria-labelledby":t.dropdownId,tabindex:"0"},on:{keydown:[function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"down",40,e.key,["Down","ArrowDown"])?null:t.handleArrowDown.apply(null,arguments)},function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"up",38,e.key,["Up","ArrowUp"])?null:t.handleArrowUp.apply(null,arguments)},function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"esc",27,e.key,["Esc","Escape"])?null:t.closeDropdown.apply(null,arguments)}]}},t._l(t.options,(function(i){return e("button",{key:i,class:{"dropdown-item":!0,selected:i===t.selectedOption},attrs:{"aria-selected":i===t.selectedOption},on:{click:function(e){return t.selectOption(i)}}},[t._v("\n\t\t\t"+t._s(i)+"\n\t\t")])})),0):t._e()])}),[],!1,null,"d960cabe",null).exports,Ft={name:"ExternalShareAction",props:{id:{type:String,required:!0},action:{type:Object,default:()=>({})},fileInfo:{type:Object,default:()=>{},required:!0},share:{type:f,default:null}},computed:{data(){return this.action.data(this)}}},qt=(0,B.Z)(Ft,(function(){var t=this;return(0,t._self._c)(t.data.is,t._g(t._b({tag:"Component"},"Component",t.data,!1),t.action.handlers),[t._v("\n\t"+t._s(t.data.text)+"\n")])}),[],!1,null,null,null).exports;var Mt=s(25108);const Wt={name:"SharingEntryLink",components:{ExternalShareAction:qt,NcActions:C(),NcActionButton:dt(),NcActionInput:Dt(),NcActionLink:E(),NcActionText:ut(),NcActionSeparator:Rt(),NcAvatar:l(),Tune:It.Z,QuickShareSelect:Ut},mixins:[mt,st],props:{canReshare:{type:Boolean,default:!0},index:{type:Number,default:null}},data:()=>({showDropdown:!1,copySuccess:!0,copied:!1,pending:!1,ExternalLegacyLinkActions:OCA.Sharing.ExternalLinkActions.state,ExternalShareActions:OCA.Sharing.ExternalShareActions.state}),computed:{title(){if(this.share&&this.share.id){if(!this.isShareOwner&&this.share.ownerDisplayName)return this.isEmailShareType?t("files_sharing","{shareWith} by {initiator}",{shareWith:this.share.shareWith,initiator:this.share.ownerDisplayName}):t("files_sharing","Shared via link by {initiator}",{initiator:this.share.ownerDisplayName});if(this.share.label&&""!==this.share.label.trim())return this.isEmailShareType?t("files_sharing","Mail share ({label})",{label:this.share.label.trim()}):t("files_sharing","Share link ({label})",{label:this.share.label.trim()});if(this.isEmailShareType)return this.share.shareWith}return this.index>1?t("files_sharing","Share link ({index})",{index:this.index}):t("files_sharing","Share link")},subtitle(){return this.isEmailShareType&&this.title!==this.share.shareWith?this.share.shareWith:null},isPasswordProtected:{get(){return this.config.enforcePasswordForPublicLink||!!this.share.password},async set(t){a.default.set(this.share,"password",t?await X():""),a.default.set(this.share,"newPassword",this.share.password)}},passwordExpirationTime(){if(null===this.share.passwordExpirationTime)return null;const t=moment(this.share.passwordExpirationTime);return!(t.diff(moment())<0)&&t.fromNow()},isTalkEnabled:()=>void 0!==OC.appswebroots.spreed,isPasswordProtectedByTalkAvailable(){return this.isPasswordProtected&&this.isTalkEnabled},isPasswordProtectedByTalk:{get(){return this.share.sendPasswordByTalk},async set(t){this.share.sendPasswordByTalk=t}},isEmailShareType(){return!!this.share&&this.share.type===this.SHARE_TYPES.SHARE_TYPE_EMAIL},canTogglePasswordProtectedByTalkAvailable(){return!(!this.isPasswordProtected||this.isEmailShareType&&!this.hasUnsavedPassword)},pendingPassword(){return this.config.enableLinkPasswordByDefault&&this.share&&!this.share.id},pendingEnforcedPassword(){return this.config.enforcePasswordForPublicLink&&this.share&&!this.share.id},pendingExpirationDate(){return this.config.isDefaultExpireDateEnforced&&this.share&&!this.share.id},hasUnsavedPassword(){return void 0!==this.share.newPassword},shareLink(){return window.location.protocol+"//"+window.location.host+(0,o.generateUrl)("/s/")+this.share.token},actionsTooltip(){return t("files_sharing",'Actions for "{title}"',{title:this.title})},copyLinkTooltip(){return this.copied?this.copySuccess?"":t("files_sharing","Cannot copy, please copy the link manually"):t("files_sharing",'Copy public link of "{title}" to clipboard',{title:this.title})},externalLegacyLinkActions(){return this.ExternalLegacyLinkActions.actions},externalLinkActions(){return this.ExternalShareActions.actions.filter((t=>t.shareType.includes(A.D.SHARE_TYPE_LINK)||t.shareType.includes(A.D.SHARE_TYPE_EMAIL)))},isPasswordPolicyEnabled(){return"object"==typeof this.config.passwordPolicy},canChangeHideDownload(){return this.fileInfo.shareAttributes.some((t=>"download"===t.key&&"permissions"===t.scope&&!1===t.enabled))}},methods:{async onNewLinkShare(){if(this.loading)return;const e={share_type:A.D.SHARE_TYPE_LINK};if(this.config.isDefaultExpireDateEnforced&&(e.expiration=this.formatDateToString(this.config.defaultExpirationDate)),this.config.enableLinkPasswordByDefault||this.config.enforcePasswordForPublicLink||this.config.isDefaultExpireDateEnforced){if(this.pending=!0,this.share&&!this.share.id){if(this.checkShare(this.share)){try{await this.pushNewLinkShare(this.share,!0)}catch(t){return this.pending=!1,Mt.error(t),!1}return!0}return this.open=!0,OC.Notification.showTemporary(t("files_sharing","Error, please enter proper password and/or expiration date")),!1}(this.config.enableLinkPasswordByDefault||this.config.enforcePasswordForPublicLink)&&(e.password=await X());const i=new f(e),s=await new Promise((t=>{this.$emit("add:share",i,t)}));this.open=!1,this.pending=!1,s.open=!0}else{const t=new f(e);await this.pushNewLinkShare(t)}},async pushNewLinkShare(e,i){try{if(this.loading)return!0;this.loading=!0,this.errors={};const s={path:(this.fileInfo.path+"/"+this.fileInfo.name).replace("//","/"),shareType:A.D.SHARE_TYPE_LINK,password:e.password,expireDate:e.expireDate,attributes:JSON.stringify(this.fileInfo.shareAttributes)};Mt.debug("Creating link share with options",s);const a=await this.createShare(s);let n;this.open=!1,Mt.debug("Link share created",a),n=i?await new Promise((t=>{this.$emit("update:share",a,t)})):await new Promise((t=>{this.$emit("add:share",a,t)})),this.config.enforcePasswordForPublicLink||n.copyLink(),(0,m.s$)(t("files_sharing","Link share created"))}catch(e){var s,a,n,r;const i=null==e||null===(s=e.response)||void 0===s||null===(a=s.data)||void 0===a||null===(n=a.ocs)||void 0===n||null===(r=n.meta)||void 0===r?void 0:r.message;if(!i)return(0,m.x2)(t("files_sharing","Error while creating the share")),void Mt.error(e);throw i.match(/password/i)?this.onSyncError("password",i):i.match(/date/i)?this.onSyncError("expireDate",i):this.onSyncError("pending",i),e}finally{this.loading=!1}},async copyLink(){try{await navigator.clipboard.writeText(this.shareLink),(0,m.s$)(t("files_sharing","Link copied")),this.$refs.copyButton.$el.focus(),this.copySuccess=!0,this.copied=!0}catch(t){this.copySuccess=!1,this.copied=!0,Mt.error(t)}finally{setTimeout((()=>{this.copySuccess=!1,this.copied=!1}),4e3)}},onPasswordChange(t){this.$set(this.share,"newPassword",t)},onPasswordDisable(){this.share.password="",this.$delete(this.share,"newPassword"),this.share.id&&this.queueUpdate("password")},onPasswordSubmit(){this.hasUnsavedPassword&&(this.share.password=this.share.newPassword.trim(),this.queueUpdate("password"))},onPasswordProtectedByTalkChange(){this.hasUnsavedPassword&&(this.share.password=this.share.newPassword.trim()),this.queueUpdate("sendPasswordByTalk","password")},onMenuClose(){this.onPasswordSubmit(),this.onNoteSubmit()},onCancel(){this.$emit("remove:share",this.share)},toggleQuickShareSelect(){this.showDropdown=!this.showDropdown}}},jt=Wt;var Zt=s(61207),Vt={};Vt.styleTagTransform=L(),Vt.setAttributes=R(),Vt.insert=D().bind(null,"head"),Vt.domAPI=P(),Vt.insertStyleElement=N(),b()(Zt.Z,Vt),Zt.Z&&Zt.Z.locals&&Zt.Z.locals;const $t={name:"SharingLinkList",components:{SharingEntryLink:(0,B.Z)(jt,(function(){var t=this,e=t._self._c;return e("li",{staticClass:"sharing-entry sharing-entry__link",class:{"sharing-entry--share":t.share}},[e("NcAvatar",{staticClass:"sharing-entry__avatar",attrs:{"is-no-user":!0,"icon-class":t.isEmailShareType?"avatar-link-share icon-mail-white":"avatar-link-share icon-public-white"}}),t._v(" "),e("div",{staticClass:"sharing-entry__summary"},[e("div",{staticClass:"sharing-entry__summary__desc",staticStyle:{"align-self":"center"}},[e("span",{staticClass:"sharing-entry__title",attrs:{title:t.title}},[t._v("\n\t\t\t\t"+t._s(t.title)+"\n\t\t\t")]),t._v(" "),t.subtitle?e("p",[t._v("\n\t\t\t\t"+t._s(t.subtitle)+"\n\t\t\t")]):t._e()]),t._v(" "),t.share&&!t.isEmailShareType&&t.share.token?e("NcActions",{ref:"copyButton",staticClass:"sharing-entry__copy"},[e("NcActionLink",{attrs:{href:t.shareLink,target:"_blank",title:t.copyLinkTooltip,"aria-label":t.copyLinkTooltip,icon:t.copied&&t.copySuccess?"icon-checkmark-color":"icon-clippy"},on:{click:function(e){return e.stopPropagation(),e.preventDefault(),t.copyLink.apply(null,arguments)}}})],1):t._e()],1),t._v(" "),!t.pending&&(t.pendingPassword||t.pendingEnforcedPassword||t.pendingExpirationDate)?e("NcActions",{staticClass:"sharing-entry__actions",attrs:{"aria-label":t.actionsTooltip,"menu-align":"right",open:t.open},on:{"update:open":function(e){t.open=e},close:t.onCancel}},[t.errors.pending?e("NcActionText",{class:{error:t.errors.pending},attrs:{icon:"icon-error"}},[t._v("\n\t\t\t"+t._s(t.errors.pending)+"\n\t\t")]):e("NcActionText",{attrs:{icon:"icon-info"}},[t._v("\n\t\t\t"+t._s(t.t("files_sharing","Please enter the following required information before creating the share"))+"\n\t\t")]),t._v(" "),t.pendingEnforcedPassword?e("NcActionText",{attrs:{icon:"icon-password"}},[t._v("\n\t\t\t"+t._s(t.t("files_sharing","Password protection (enforced)"))+"\n\t\t")]):t.pendingPassword?e("NcActionCheckbox",{staticClass:"share-link-password-checkbox",attrs:{checked:t.isPasswordProtected,disabled:t.config.enforcePasswordForPublicLink||t.saving},on:{"update:checked":function(e){t.isPasswordProtected=e},uncheck:t.onPasswordDisable}},[t._v("\n\t\t\t"+t._s(t.t("files_sharing","Password protection"))+"\n\t\t")]):t._e(),t._v(" "),t.pendingEnforcedPassword||t.share.password?e("NcActionInput",{staticClass:"share-link-password",attrs:{value:t.share.password,disabled:t.saving,required:t.config.enableLinkPasswordByDefault||t.config.enforcePasswordForPublicLink,minlength:t.isPasswordPolicyEnabled&&t.config.passwordPolicy.minLength,icon:"",autocomplete:"new-password"},on:{"update:value":function(e){return t.$set(t.share,"password",e)},submit:t.onNewLinkShare}},[t._v("\n\t\t\t"+t._s(t.t("files_sharing","Enter a password"))+"\n\t\t")]):t._e(),t._v(" "),t.pendingExpirationDate?e("NcActionText",{attrs:{icon:"icon-calendar-dark"}},[t._v("\n\t\t\t"+t._s(t.t("files_sharing","Expiration date (enforced)"))+"\n\t\t")]):t._e(),t._v(" "),t.pendingExpirationDate?e("NcActionInput",{staticClass:"share-link-expire-date",attrs:{disabled:t.saving,"is-native-picker":!0,"hide-label":!0,value:new Date(t.share.expireDate),type:"date",min:t.dateTomorrow,max:t.maxExpirationDateEnforced},on:{input:t.onExpirationChange}},[t._v("\n\t\t\t"+t._s(t.t("files_sharing","Enter a date"))+"\n\t\t")]):t._e(),t._v(" "),e("NcActionButton",{attrs:{icon:"icon-checkmark"},on:{click:function(e){return e.preventDefault(),e.stopPropagation(),t.onNewLinkShare.apply(null,arguments)}}},[t._v("\n\t\t\t"+t._s(t.t("files_sharing","Create share"))+"\n\t\t")]),t._v(" "),e("NcActionButton",{attrs:{icon:"icon-close"},on:{click:function(e){return e.preventDefault(),e.stopPropagation(),t.onCancel.apply(null,arguments)}}},[t._v("\n\t\t\t"+t._s(t.t("files_sharing","Cancel"))+"\n\t\t")])],1):t.loading?e("div",{staticClass:"icon-loading-small sharing-entry__loading"}):e("NcActions",{staticClass:"sharing-entry__actions",attrs:{"aria-label":t.actionsTooltip,"menu-align":"right",open:t.open},on:{"update:open":function(e){t.open=e},close:t.onMenuClose}},[t.share?[t.share.canEdit&&t.canReshare?[e("NcActionButton",{attrs:{disabled:t.saving},on:{click:function(e){return e.preventDefault(),t.openSharingDetails.apply(null,arguments)}},scopedSlots:t._u([{key:"icon",fn:function(){return[e("Tune")]},proxy:!0}],null,!1,961531849)},[t._v("\n\t\t\t\t\t"+t._s(t.t("files_sharing","Customize link"))+"\n\t\t\t\t")])]:t._e(),t._v(" "),e("NcActionSeparator"),t._v(" "),t._l(t.externalLinkActions,(function(i){return e("ExternalShareAction",{key:i.id,attrs:{id:i.id,action:i,"file-info":t.fileInfo,share:t.share}})})),t._v(" "),t._l(t.externalLegacyLinkActions,(function(i,s){let{icon:a,url:n,name:r}=i;return e("NcActionLink",{key:s,attrs:{href:n(t.shareLink),icon:a,target:"_blank"}},[t._v("\n\t\t\t\t"+t._s(r)+"\n\t\t\t")])})),t._v(" "),!t.isEmailShareType&&t.canReshare?e("NcActionButton",{staticClass:"new-share-link",attrs:{icon:"icon-add"},on:{click:function(e){return e.preventDefault(),e.stopPropagation(),t.onNewLinkShare.apply(null,arguments)}}},[t._v("\n\t\t\t\t"+t._s(t.t("files_sharing","Add another link"))+"\n\t\t\t")]):t._e(),t._v(" "),t.share.canDelete?e("NcActionButton",{attrs:{icon:"icon-close",disabled:t.saving},on:{click:function(e){return e.preventDefault(),t.onDelete.apply(null,arguments)}}},[t._v("\n\t\t\t\t"+t._s(t.t("files_sharing","Unshare"))+"\n\t\t\t")]):t._e()]:t.canReshare?e("NcActionButton",{staticClass:"new-share-link",attrs:{title:t.t("files_sharing","Create a new share link"),"aria-label":t.t("files_sharing","Create a new share link"),icon:t.loading?"icon-loading-small":"icon-add"},on:{click:function(e){return e.preventDefault(),e.stopPropagation(),t.onNewLinkShare.apply(null,arguments)}}}):t._e()],2)],1)}),[],!1,null,"12bdf14e",null).exports},mixins:[_,st],props:{fileInfo:{type:Object,default:()=>{},required:!0},shares:{type:Array,default:()=>[],required:!0},canReshare:{type:Boolean,required:!0}},data:()=>({canLinkShare:OC.getCapabilities().files_sharing.public.enabled}),computed:{hasLinkShares(){return this.shares.filter((t=>t.type===this.SHARE_TYPES.SHARE_TYPE_LINK)).length>0},hasShares(){return this.shares.length>0}},methods:{addShare(t,e){this.shares.unshift(t),this.awaitForShare(t,e)},awaitForShare(t,e){this.$nextTick((()=>{const i=this.$children.find((e=>e.share===t));i&&e(i)}))},removeShare(t){const e=this.shares.findIndex((e=>e===t));this.shares.splice(e,1)}}},Gt=(0,B.Z)($t,(function(){var t=this,e=t._self._c;return t.canLinkShare?e("ul",{staticClass:"sharing-link-list"},[!t.hasLinkShares&&t.canReshare?e("SharingEntryLink",{attrs:{"can-reshare":t.canReshare,"file-info":t.fileInfo},on:{"add:share":t.addShare}}):t._e(),t._v(" "),t.hasShares?t._l(t.shares,(function(i,s){return e("SharingEntryLink",{key:i.id,attrs:{index:t.shares.length>1?s+1:null,"can-reshare":t.canReshare,share:t.shares[s],"file-info":t.fileInfo},on:{"update:share":[function(e){return t.$set(t.shares,s,e)},function(e){return t.awaitForShare(...arguments)}],"add:share":function(e){return t.addShare(...arguments)},"remove:share":t.removeShare,"open-sharing-details":function(e){return t.openSharingDetails(i)}}})})):t._e()],2):t._e()}),[],!1,null,null,null).exports;var zt=s(10861),Kt=s.n(zt),Qt=s(89115);const Jt={name:"SharingEntry",components:{NcButton:Kt(),NcAvatar:l(),DotsHorizontalIcon:Qt.default,NcSelect:K(),QuickShareSelect:Ut},mixins:[mt,st],data:()=>({showDropdown:!1}),computed:{title(){let e=this.share.shareWithDisplayName;return this.share.type===this.SHARE_TYPES.SHARE_TYPE_GROUP?e+=" (".concat(t("files_sharing","group"),")"):this.share.type===this.SHARE_TYPES.SHARE_TYPE_ROOM?e+=" (".concat(t("files_sharing","conversation"),")"):this.share.type===this.SHARE_TYPES.SHARE_TYPE_REMOTE?e+=" (".concat(t("files_sharing","remote"),")"):this.share.type===this.SHARE_TYPES.SHARE_TYPE_REMOTE_GROUP?e+=" (".concat(t("files_sharing","remote group"),")"):this.share.type===this.SHARE_TYPES.SHARE_TYPE_GUEST&&(e+=" (".concat(t("files_sharing","guest"),")")),e},tooltip(){if(this.share.owner!==this.share.uidFileOwner){const e={user:this.share.shareWithDisplayName,owner:this.share.ownerDisplayName};return this.share.type===this.SHARE_TYPES.SHARE_TYPE_GROUP?t("files_sharing","Shared with the group {user} by {owner}",e):this.share.type===this.SHARE_TYPES.SHARE_TYPE_ROOM?t("files_sharing","Shared with the conversation {user} by {owner}",e):t("files_sharing","Shared with {user} by {owner}",e)}return null},hasStatus(){return this.share.type===this.SHARE_TYPES.SHARE_TYPE_USER&&"object"==typeof this.share.status&&!Array.isArray(this.share.status)}},methods:{onMenuClose(){this.onNoteSubmit()},toggleQuickShareSelect(){this.showDropdown=!this.showDropdown}}};var Xt=s(82674),te={};te.styleTagTransform=L(),te.setAttributes=R(),te.insert=D().bind(null,"head"),te.domAPI=P(),te.insertStyleElement=N(),b()(Xt.Z,te),Xt.Z&&Xt.Z.locals&&Xt.Z.locals;const ee={name:"SharingList",components:{SharingEntry:(0,B.Z)(Jt,(function(){var t=this,e=t._self._c;return e("li",{staticClass:"sharing-entry"},[e("NcAvatar",{staticClass:"sharing-entry__avatar",attrs:{"is-no-user":t.share.type!==t.SHARE_TYPES.SHARE_TYPE_USER,user:t.share.shareWith,"display-name":t.share.shareWithDisplayName,"menu-position":"left",url:t.share.shareWithAvatar}}),t._v(" "),e("div",{staticClass:"sharing-entry__summary"},[e(t.share.shareWithLink?"a":"div",{tag:"component",staticClass:"sharing-entry__summary__desc",attrs:{title:t.tooltip,"aria-label":t.tooltip,href:t.share.shareWithLink}},[e("span",[t._v(t._s(t.title)+"\n\t\t\t\t"),t.isUnique?t._e():e("span",{staticClass:"sharing-entry__summary__desc-unique"},[t._v(" ("+t._s(t.share.shareWithDisplayNameUnique)+")")]),t._v(" "),t.hasStatus&&t.share.status.message?e("small",[t._v("("+t._s(t.share.status.message)+")")]):t._e()])])],1),t._v(" "),e("NcButton",{staticClass:"sharing-entry__action",attrs:{"aria-label":t.t("files_sharing","Open Sharing Details"),type:"tertiary-no-background"},on:{click:function(e){return t.openSharingDetails(t.share)}},scopedSlots:t._u([{key:"icon",fn:function(){return[e("DotsHorizontalIcon",{attrs:{size:20}})]},proxy:!0}])})],1)}),[],!1,null,"b6613238",null).exports},mixins:[_,st],props:{fileInfo:{type:Object,default:()=>{},required:!0},shares:{type:Array,default:()=>[],required:!0}},computed:{hasShares(){return 0===this.shares.length},isUnique(){return t=>[...this.shares].filter((e=>t.type===this.SHARE_TYPES.SHARE_TYPE_USER&&t.shareWithDisplayName===e.shareWithDisplayName)).length<=1}}},ie=(0,B.Z)(ee,(function(){var t=this,e=t._self._c;return e("ul",{staticClass:"sharing-sharee-list"},t._l(t.shares,(function(i){return e("SharingEntry",{key:i.id,attrs:{"file-info":t.fileInfo,share:i,"is-unique":t.isUnique(i)},on:{"open-sharing-details":function(e){return t.openSharingDetails(i)}}})})),1)}),[],!1,null,null,null).exports;var se=s(36029),ae=s.n(se),ne=s(36767),re=s.n(ne),oe=s(19286),he=s.n(oe),le=s(20571),de=s.n(le),ce=s(10549),pe=s(82675),ue=s(73229),Ae=s(41447),ge=s(19695),fe=s(50413),_e=s(42055),me=s(76205),we=s(82640),Ee=s(75762),ve=s(20404),Ce=s(25108);const ye={name:"SharingDetailsTab",components:{NcAvatar:l(),NcButton:Kt(),NcInputField:ae(),NcDatetimePicker:re(),NcDateTimePickerNative:he(),NcCheckboxRadioSwitch:de(),CloseIcon:pe.default,CircleIcon:ce.Z,EditIcon:ue.default,LinkIcon:ge.Z,GroupIcon:fe.Z,ShareIcon:_e.Z,UserIcon:me.Z,UploadIcon:Ee.Z,ViewIcon:we.default,MenuDownIcon:ve.Z,DotsHorizontalIcon:Qt.default},mixins:[_,it,mt],props:{shareRequestValue:{type:Object,required:!1},fileInfo:{type:Object,required:!0},share:{type:Object,required:!0}},data:()=>({writeNoteToRecipientIsChecked:!1,sharingPermission:ft.ALL.toString(),revertSharingPermission:ft.ALL.toString(),setCustomPermissions:!1,passwordError:!1,advancedSectionAccordionExpanded:!1,bundledPermissions:ft,isFirstComponentLoad:!0,test:!1}),computed:{canEditFileType(){var t;return this.isFolder||["text/markdown","text/plain","application/cmd","application/x-empty","application/x-msdos-program","application/javascript","application/json","application/x-perl","application/x-php","application/x-tex","application/xml","application/yaml","text/css","text/csv","text/html","text/org","text/x-c","text/x-c++src","text/x-h","text/x-java-source","text/x-ldif","text/x-python","text/x-shellscript"].includes(null===(t=this.fileInfo.mimetype)||void 0===t?void 0:t.toLowerCase())},title(){let e=t("files_sharing","Share with ");return this.share.type===this.SHARE_TYPES.SHARE_TYPE_USER?e+=this.share.shareWithDisplayName:this.share.type===this.SHARE_TYPES.SHARE_TYPE_LINK?e=t("files_sharing","Share link"):this.share.type===this.SHARE_TYPES.SHARE_TYPE_GROUP?e+=" (".concat(t("files_sharing","group"),")"):this.share.type===this.SHARE_TYPES.SHARE_TYPE_ROOM?e+=" (".concat(t("files_sharing","conversation"),")"):this.share.type===this.SHARE_TYPES.SHARE_TYPE_REMOTE?e+=" (".concat(t("files_sharing","remote"),")"):this.share.type===this.SHARE_TYPES.SHARE_TYPE_REMOTE_GROUP?e+=" (".concat(t("files_sharing","remote group"),")"):this.share.type===this.SHARE_TYPES.SHARE_TYPE_GUEST&&(e+=" (".concat(t("files_sharing","guest"),")")),e},canEdit:{get(){return this.share.hasUpdatePermission},set(t){this.updateAtomicPermissions({isEditChecked:t})}},canCreate:{get(){return this.share.hasCreatePermission},set(t){this.updateAtomicPermissions({isCreateChecked:t})}},canDelete:{get(){return this.share.hasDeletePermission},set(t){this.updateAtomicPermissions({isDeleteChecked:t})}},canReshare:{get(){return this.share.hasSharePermission},set(t){this.updateAtomicPermissions({isReshareChecked:t})}},canDownload:{get(){return this.share.hasDownloadPermission},set(t){this.updateAtomicPermissions({isDownloadChecked:t})}},hasRead:{get(){return this.share.hasReadPermission},set(t){this.updateAtomicPermissions({isReadChecked:t})}},hasExpirationDate:{get(){return this.isValidShareAttribute(this.share.expireDate)},set(t){this.share.expireDate=t?this.formatDateToString(this.defaultExpiryDate):""}},isPasswordProtected:{get(){return this.config.enforcePasswordForPublicLink||!!this.share.password},async set(t){t?(this.share.password=await X(),this.$set(this.share,"newPassword",this.share.password)):(this.share.password="",this.$delete(this.share,"newPassword"))}},isFolder(){return"dir"===this.fileInfo.type},isSetDownloadButtonVisible(){return this.isFolder||["application/msword","application/vnd.openxmlformats-officedocument.wordprocessingml.document","application/vnd.ms-powerpoint","application/vnd.openxmlformats-officedocument.presentationml.presentation","application/vnd.ms-excel","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet","application/vnd.oasis.opendocument.text","application/vnd.oasis.opendocument.spreadsheet","application/vnd.oasis.opendocument.presentation"].includes(this.fileInfo.mimetype)},isPasswordEnforced(){return this.isPublicShare&&this.config.enforcePasswordForPublicLink},defaultExpiryDate(){return(this.isGroupShare||this.isUserShare)&&this.config.isDefaultInternalExpireDateEnabled?new Date(this.config.defaultInternalExpirationDate):this.isRemoteShare&&this.config.isDefaultRemoteExpireDateEnabled?new Date(this.config.defaultRemoteExpireDateEnabled):this.isPublicShare&&this.config.isDefaultExpireDateEnabled?new Date(this.config.defaultExpirationDate):new Date((new Date).setDate((new Date).getDate()+1))},isUserShare(){return this.share.type===this.SHARE_TYPES.SHARE_TYPE_USER},isGroupShare(){return this.share.type===this.SHARE_TYPES.SHARE_TYPE_GROUP},isNewShare(){return null===this.share.id||void 0===this.share.id},allowsFileDrop(){return!(!this.isFolder||!this.config.isPublicUploadEnabled||this.share.type!==this.SHARE_TYPES.SHARE_TYPE_LINK&&this.share.type!==this.SHARE_TYPES.SHARE_TYPE_EMAIL)},hasFileDropPermissions(){return this.share.permissions===this.bundledPermissions.FILE_DROP},shareButtonText(){return this.isNewShare?t("files_sharing","Save share"):t("files_sharing","Update share")},canSetEdit(){return this.fileInfo.sharePermissions&OC.PERMISSION_UPDATE||this.canEdit},canSetCreate(){return this.fileInfo.sharePermissions&OC.PERMISSION_CREATE||this.canCreate},canSetDelete(){return this.fileInfo.sharePermissions&OC.PERMISSION_DELETE||this.canDelete},canSetReshare(){return this.fileInfo.sharePermissions&OC.PERMISSION_SHARE||this.canReshare},canSetDownload(){return this.fileInfo.canDownload()||this.canDownload},hasUnsavedPassword(){return void 0!==this.share.newPassword},passwordExpirationTime(){if(!this.isValidShareAttribute(this.share.passwordExpirationTime))return null;const t=moment(this.share.passwordExpirationTime);return!(t.diff(moment())<0)&&t.fromNow()},isTalkEnabled:()=>void 0!==OC.appswebroots.spreed,isPasswordProtectedByTalkAvailable(){return this.isPasswordProtected&&this.isTalkEnabled},isPasswordProtectedByTalk:{get(){return this.share.sendPasswordByTalk},async set(t){this.share.sendPasswordByTalk=t}},isEmailShareType(){return!!this.share&&this.share.type===this.SHARE_TYPES.SHARE_TYPE_EMAIL},canTogglePasswordProtectedByTalkAvailable(){return!(!this.isPublicShare||!this.isPasswordProtected||this.isEmailShareType&&!this.hasUnsavedPassword||void 0===OC.appswebroots.spreed)},canChangeHideDownload(){return this.fileInfo.shareAttributes.some((t=>"download"===t.key&&"permissions"===t.scope&&!1===t.enabled))},customPermissionsList(){const t={[gt.READ]:this.t("files_sharing","Read"),[gt.CREATE]:this.t("files_sharing","Create"),[gt.UPDATE]:this.t("files_sharing","Edit"),[gt.SHARE]:this.t("files_sharing","Share"),[gt.DELETE]:this.t("files_sharing","Delete")};return[gt.READ,gt.CREATE,gt.UPDATE,gt.SHARE,gt.DELETE].filter((t=>{return e=this.share.permissions,i=t,e!==gt.NONE&&(e&i)===i;var e,i})).map(((e,i)=>0===i?t[e]:t[e].toLocaleLowerCase((0,n.G3)()))).join(", ")},advancedControlExpandedValue(){return this.advancedSectionAccordionExpanded?"true":"false"}},watch:{setCustomPermissions(t){this.sharingPermission=t?"custom":this.revertSharingPermission}},beforeMount(){this.initializePermissions(),this.initializeAttributes(),Ce.debug("shareSentIn",this.share),Ce.debug("config",this.config)},mounted(){var t,e;null===(t=this.$refs.quickPermissions)||void 0===t||null===(e=t.querySelector("input:checked"))||void 0===e||e.focus()},methods:{updateAtomicPermissions(){let{isReadChecked:t=this.hasRead,isEditChecked:e=this.canEdit,isCreateChecked:i=this.canCreate,isDeleteChecked:s=this.canDelete,isReshareChecked:a=this.canReshare,isDownloadChecked:n=this.canDownload}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const r=0|(t?gt.READ:0)|(i?gt.CREATE:0)|(s?gt.DELETE:0)|(e?gt.UPDATE:0)|(a?gt.SHARE:0);this.share.permissions=r,this.share.hasDownloadPermission!==n&&this.$set(this.share,"hasDownloadPermission",n)},expandCustomPermissions(){this.advancedSectionAccordionExpanded||(this.advancedSectionAccordionExpanded=!0),this.toggleCustomPermissions()},toggleCustomPermissions(t){const e="custom"===this.sharingPermission;this.revertSharingPermission=e?"custom":t,this.setCustomPermissions=e},async initializeAttributes(){if(this.isNewShare)return this.isPasswordEnforced&&this.isPublicShare&&(this.$set(this.share,"newPassword",await X()),this.advancedSectionAccordionExpanded=!0),this.isPublicShare&&this.config.isDefaultExpireDateEnabled?this.share.expireDate=this.config.defaultExpirationDate.toDateString():this.isRemoteShare&&this.config.isDefaultRemoteExpireDateEnabled?this.share.expireDate=this.config.defaultRemoteExpirationDateString.toDateString():this.config.isDefaultInternalExpireDateEnabled&&(this.share.expireDate=this.config.defaultInternalExpirationDate.toDateString()),void(this.isValidShareAttribute(this.share.expireDate)&&(this.advancedSectionAccordionExpanded=!0));!this.isValidShareAttribute(this.share.expireDate)&&this.isExpiryDateEnforced&&(this.hasExpirationDate=!0),(this.isValidShareAttribute(this.share.password)||this.isValidShareAttribute(this.share.expireDate)||this.isValidShareAttribute(this.share.label))&&(this.advancedSectionAccordionExpanded=!0)},handleShareType(){this.share.share_type&&(this.share.type=this.share.share_type),"shareType"in this.share&&(this.share.type=this.share.shareType)},handleDefaultPermissions(){if(this.isNewShare){const t=this.config.defaultPermissions;t===ft.READ_ONLY||t===ft.ALL?this.sharingPermission=t.toString():(this.sharingPermission="custom",this.share.permissions=t,this.advancedSectionAccordionExpanded=!0,this.setCustomPermissions=!0)}},handleCustomPermissions(){this.isNewShare||!this.hasCustomPermissions&&!this.share.setCustomPermissions?this.sharingPermission=this.share.permissions.toString():(this.sharingPermission="custom",this.advancedSectionAccordionExpanded=!0,this.setCustomPermissions=!0)},initializePermissions(){this.handleShareType(),this.handleDefaultPermissions(),this.handleCustomPermissions()},async saveShare(){const t=["permissions","attributes","note","expireDate"];this.isPublicShare&&t.push("label","password","hideDownload");const e=parseInt(this.sharingPermission);if(this.setCustomPermissions?this.updateAtomicPermissions():this.share.permissions=e,this.isFolder||this.share.permissions!==ft.ALL||(this.share.permissions=ft.ALL_FILE),this.writeNoteToRecipientIsChecked||(this.share.note=""),this.isPasswordProtected?this.hasUnsavedPassword&&this.isValidShareAttribute(this.share.newPassword)?(this.share.password=this.share.newPassword,this.$delete(this.share,"newPassword")):this.isPasswordEnforced&&!this.isValidShareAttribute(this.share.password)&&(this.passwordError=!0):this.share.password="",this.hasExpirationDate||(this.share.expireDate=""),this.isNewShare){const t={permissions:this.share.permissions,shareType:this.share.type,shareWith:this.share.shareWith,attributes:this.share.attributes,note:this.share.note,fileInfo:this.fileInfo};this.hasExpirationDate&&(t.expireDate=this.share.expireDate),this.isPasswordProtected&&(t.password=this.share.password);const e=await this.addShare(t,this.fileInfo);this.share=e,this.$emit("add:share",this.share)}else this.queueUpdate(...t);this.$emit("close-sharing-details")},async addShare(t,e){Ce.debug("Adding a new share from the input for",t);try{const i=(e.path+"/"+e.name).replace("//","/");return await this.createShare({path:i,shareType:t.shareType,shareWith:t.shareWith,permissions:t.permissions,attributes:JSON.stringify(e.shareAttributes),...t.note?{note:t.note}:{},...t.password?{password:t.password}:{},...t.expireDate?{expireDate:t.expireDate}:{}})}catch(t){Ce.error("Error while adding new share",t)}},async removeShare(){await this.onDelete(),this.$emit("close-sharing-details")},onPasswordChange(t){this.passwordError=!this.isValidShareAttribute(t),this.$set(this.share,"newPassword",t)},onPasswordProtectedByTalkChange(){this.hasUnsavedPassword&&(this.share.password=this.share.newPassword.trim()),this.queueUpdate("sendPasswordByTalk","password")},isValidShareAttribute:t=>![null,void 0].includes(t)&&t.trim().length>0,getShareTypeIcon(t){switch(t){case this.SHARE_TYPES.SHARE_TYPE_LINK:return ge.Z;case this.SHARE_TYPES.SHARE_TYPE_GUEST:return me.Z;case this.SHARE_TYPES.SHARE_TYPE_REMOTE_GROUP:case this.SHARE_TYPES.SHARE_TYPE_GROUP:return fe.Z;case this.SHARE_TYPES.SHARE_TYPE_EMAIL:return Ae.Z;case this.SHARE_TYPES.SHARE_TYPE_CIRCLE:return ce.Z;case this.SHARE_TYPES.SHARE_TYPE_ROOM:case this.SHARE_TYPES.SHARE_TYPE_DECK:case this.SHARE_TYPES.SHARE_TYPE_SCIENCEMESH:return _e.Z;default:return null}}}};var Se=s(78211),be={};be.styleTagTransform=L(),be.setAttributes=R(),be.insert=D().bind(null,"head"),be.domAPI=P(),be.insertStyleElement=N(),b()(Se.Z,be),Se.Z&&Se.Z.locals&&Se.Z.locals;const xe=(0,B.Z)(ye,(function(){var t,e=this,i=e._self._c;return i("div",{staticClass:"sharingTabDetailsView"},[i("div",{staticClass:"sharingTabDetailsView__header"},[i("span",[e.isUserShare?i("NcAvatar",{staticClass:"sharing-entry__avatar",attrs:{"is-no-user":e.share.shareType!==e.SHARE_TYPES.SHARE_TYPE_USER,user:e.share.shareWith,"display-name":e.share.shareWithDisplayName,"menu-position":"left",url:e.share.shareWithAvatar}}):e._e(),e._v(" "),i(e.getShareTypeIcon(e.share.type),{tag:"component",attrs:{size:32}})],1),e._v(" "),i("span",[i("h1",[e._v(e._s(e.title))])])]),e._v(" "),i("div",{staticClass:"sharingTabDetailsView__wrapper"},[i("div",{ref:"quickPermissions",staticClass:"sharingTabDetailsView__quick-permissions"},[i("div",[i("NcCheckboxRadioSwitch",{attrs:{"button-variant":!0,checked:e.sharingPermission,value:e.bundledPermissions.READ_ONLY.toString(),name:"sharing_permission_radio",type:"radio","button-variant-grouped":"vertical"},on:{"update:checked":[function(t){e.sharingPermission=t},e.toggleCustomPermissions]}},[i("ViewIcon",{attrs:{size:20}}),e._v(" "),i("span",[e._v(e._s(e.t("files_sharing","View only")))])],1),e._v(" "),e.canEditFileType&&!e.isPublicShare?i("NcCheckboxRadioSwitch",{attrs:{"button-variant":!0,checked:e.sharingPermission,value:e.bundledPermissions.ALL.toString(),name:"sharing_permission_radio",type:"radio","button-variant-grouped":"vertical"},on:{"update:checked":[function(t){e.sharingPermission=t},e.toggleCustomPermissions]}},[i("EditIcon",{attrs:{size:20}}),e._v(" "),[i("span",[e._v(e._s(e.t("files_sharing","Allow editing")))])]],2):e._e(),e._v(" "),e.allowsFileDrop?i("NcCheckboxRadioSwitch",{attrs:{"button-variant":!0,checked:e.sharingPermission,value:e.bundledPermissions.FILE_DROP.toString(),name:"sharing_permission_radio",type:"radio","button-variant-grouped":"vertical"},on:{"update:checked":[function(t){e.sharingPermission=t},e.toggleCustomPermissions]}},[i("UploadIcon",{attrs:{size:20}}),e._v(" "),i("span",[e._v(e._s(e.t("files_sharing","File drop")))]),e._v(" "),i("small",[e._v(e._s(e.t("files_sharing","Upload only")))])],1):e._e(),e._v(" "),i("NcCheckboxRadioSwitch",{attrs:{"button-variant":!0,checked:e.sharingPermission,value:"custom",name:"sharing_permission_radio",type:"radio","button-variant-grouped":"vertical"},on:{"update:checked":[function(t){e.sharingPermission=t},e.expandCustomPermissions]}},[i("DotsHorizontalIcon",{attrs:{size:20}}),e._v(" "),i("span",[e._v(e._s(e.t("files_sharing","Custom permissions")))]),e._v(" "),i("small",[e._v(e._s(e.customPermissionsList))])],1)],1)]),e._v(" "),i("div",{staticClass:"sharingTabDetailsView__advanced-control"},[i("NcButton",{attrs:{id:"advancedSectionAccordionAdvancedControl",type:"tertiary",alignment:"end-reverse"},on:{click:function(t){e.advancedSectionAccordionExpanded=!e.advancedSectionAccordionExpanded}},scopedSlots:e._u([{key:"icon",fn:function(){return[i("MenuDownIcon")]},proxy:!0}])},[e._v("\n\t\t\t\t\t"+e._s(e.t("files_sharing","Advanced settings"))+"\n\t\t\t\t\t")])],1),e._v(" "),e.advancedSectionAccordionExpanded?i("div",{staticClass:"sharingTabDetailsView__advanced",attrs:{id:"advancedSectionAccordionAdvanced","aria-labelledby":"advancedSectionAccordionAdvancedControl",role:"region"}},[i("section",[e.isPublicShare?i("NcInputField",{attrs:{value:e.share.label,type:"text",label:e.t("files_sharing","Share label")},on:{"update:value":function(t){return e.$set(e.share,"label",t)}}}):e._e(),e._v(" "),e.isPublicShare?[i("NcCheckboxRadioSwitch",{attrs:{checked:e.isPasswordProtected,disabled:e.isPasswordEnforced},on:{"update:checked":function(t){e.isPasswordProtected=t}}},[e._v("\n\t\t\t\t\t\t\t"+e._s(e.t("files_sharing","Set password"))+"\n\t\t\t\t\t\t")]),e._v(" "),e.isPasswordProtected?i("NcInputField",{attrs:{type:e.hasUnsavedPassword?"text":"password",value:e.hasUnsavedPassword?e.share.newPassword:"***************",error:e.passwordError,required:e.isPasswordEnforced,label:e.t("files_sharing","Password")},on:{"update:value":e.onPasswordChange}}):e._e(),e._v(" "),e.isEmailShareType&&e.passwordExpirationTime?i("span",{attrs:{icon:"icon-info"}},[e._v("\n\t\t\t\t\t\t\t"+e._s(e.t("files_sharing","Password expires {passwordExpirationTime}",{passwordExpirationTime:e.passwordExpirationTime}))+"\n\t\t\t\t\t\t")]):e.isEmailShareType&&null!==e.passwordExpirationTime?i("span",{attrs:{icon:"icon-error"}},[e._v("\n\t\t\t\t\t\t\t"+e._s(e.t("files_sharing","Password expired"))+"\n\t\t\t\t\t\t")]):e._e()]:e._e(),e._v(" "),e.canTogglePasswordProtectedByTalkAvailable?i("NcCheckboxRadioSwitch",{attrs:{checked:e.isPasswordProtectedByTalk},on:{"update:checked":[function(t){e.isPasswordProtectedByTalk=t},e.onPasswordProtectedByTalkChange]}},[e._v("\n\t\t\t\t\t\t"+e._s(e.t("files_sharing","Video verification"))+"\n\t\t\t\t\t")]):e._e(),e._v(" "),i("NcCheckboxRadioSwitch",{attrs:{checked:e.hasExpirationDate,disabled:e.isExpiryDateEnforced},on:{"update:checked":function(t){e.hasExpirationDate=t}}},[e._v("\n\t\t\t\t\t\t"+e._s(e.isExpiryDateEnforced?e.t("files_sharing","Expiration date (enforced)"):e.t("files_sharing","Set expiration date"))+"\n\t\t\t\t\t")]),e._v(" "),e.hasExpirationDate?i("NcDateTimePickerNative",{attrs:{id:"share-date-picker",value:new Date(null!==(t=e.share.expireDate)&&void 0!==t?t:e.dateTomorrow),min:e.dateTomorrow,max:e.maxExpirationDateEnforced,"hide-label":!0,placeholder:e.t("files_sharing","Expiration date"),type:"date"},on:{input:e.onExpirationChange}}):e._e(),e._v(" "),e.isPublicShare?i("NcCheckboxRadioSwitch",{attrs:{disabled:e.canChangeHideDownload,checked:e.share.hideDownload},on:{"update:checked":[function(t){return e.$set(e.share,"hideDownload",t)},function(t){return e.queueUpdate("hideDownload")}]}},[e._v("\n\t\t\t\t\t\t"+e._s(e.t("files_sharing","Hide download"))+"\n\t\t\t\t\t")]):e._e(),e._v(" "),e.isPublicShare?e._e():i("NcCheckboxRadioSwitch",{attrs:{disabled:!e.canSetDownload,checked:e.canDownload},on:{"update:checked":function(t){e.canDownload=t}}},[e._v("\n\t\t\t\t\t\t"+e._s(e.t("files_sharing","Allow download"))+"\n\t\t\t\t\t")]),e._v(" "),i("NcCheckboxRadioSwitch",{attrs:{checked:e.writeNoteToRecipientIsChecked},on:{"update:checked":function(t){e.writeNoteToRecipientIsChecked=t}}},[e._v("\n\t\t\t\t\t\t"+e._s(e.t("files_sharing","Note to recipient"))+"\n\t\t\t\t\t")]),e._v(" "),e.writeNoteToRecipientIsChecked?[i("label",{attrs:{for:"share-note-textarea"}},[e._v("\n\t\t\t\t\t\t\t"+e._s(e.t("files_sharing","Enter a note for the share recipient"))+"\n\t\t\t\t\t\t")]),e._v(" "),i("textarea",{attrs:{id:"share-note-textarea"},domProps:{value:e.share.note},on:{input:function(t){e.share.note=t.target.value}}})]:e._e(),e._v(" "),e.isPublicShare?e._e():i("NcCheckboxRadioSwitch",{attrs:{checked:e.setCustomPermissions},on:{"update:checked":function(t){e.setCustomPermissions=t}}},[e._v("\n\t\t\t\t\t\t"+e._s(e.t("files_sharing","Custom permissions"))+"\n\t\t\t\t\t")]),e._v(" "),e.setCustomPermissions&&!e.isPublicShare?i("section",{staticClass:"custom-permissions-group"},[i("NcCheckboxRadioSwitch",{attrs:{disabled:!e.allowsFileDrop&&e.share.type===e.SHARE_TYPES.SHARE_TYPE_LINK,checked:e.hasRead},on:{"update:checked":function(t){e.hasRead=t}}},[e._v("\n\t\t\t\t\t\t\t"+e._s(e.t("files_sharing","Read"))+"\n\t\t\t\t\t\t")]),e._v(" "),e.isFolder?i("NcCheckboxRadioSwitch",{attrs:{disabled:!e.canSetCreate,checked:e.canCreate},on:{"update:checked":function(t){e.canCreate=t}}},[e._v("\n\t\t\t\t\t\t\t"+e._s(e.t("files_sharing","Create"))+"\n\t\t\t\t\t\t")]):e._e(),e._v(" "),i("NcCheckboxRadioSwitch",{attrs:{disabled:!e.canSetEdit||!e.canEditFileType,checked:e.canEdit},on:{"update:checked":function(t){e.canEdit=t}}},[e._v("\n\t\t\t\t\t\t\t"+e._s(e.t("files_sharing","Update"))+"\n\t\t\t\t\t\t")]),e._v(" "),e.config.isResharingAllowed&&e.share.type!==e.SHARE_TYPES.SHARE_TYPE_LINK?i("NcCheckboxRadioSwitch",{attrs:{disabled:!e.canSetReshare,checked:e.canReshare},on:{"update:checked":function(t){e.canReshare=t}}},[e._v("\n\t\t\t\t\t\t\t"+e._s(e.t("files_sharing","Share"))+"\n\t\t\t\t\t\t")]):e._e(),e._v(" "),i("NcCheckboxRadioSwitch",{attrs:{disabled:!e.canSetDelete,checked:e.canDelete},on:{"update:checked":function(t){e.canDelete=t}}},[e._v("\n\t\t\t\t\t\t\t"+e._s(e.t("files_sharing","Delete"))+"\n\t\t\t\t\t\t")])],1):e._e()],2)]):e._e()]),e._v(" "),i("div",{staticClass:"sharingTabDetailsView__footer"},[i("div",{staticClass:"sharingTabDetailsView__delete"},[e.isNewShare?e._e():i("NcButton",{attrs:{"aria-label":e.t("files_sharing","Delete share"),disabled:!1,readonly:!1,type:"tertiary"},on:{click:function(t){return t.preventDefault(),e.removeShare.apply(null,arguments)}},scopedSlots:e._u([{key:"icon",fn:function(){return[i("CloseIcon",{attrs:{size:16}})]},proxy:!0}],null,!1,2746485232)},[e._v("\n\t\t\t\t\t"+e._s(e.t("files_sharing","Delete share"))+"\n\t\t\t\t")])],1),e._v(" "),i("div",{staticClass:"button-group"},[i("NcButton",{on:{click:function(t){return e.$emit("close-sharing-details")}}},[e._v("\n\t\t\t\t\t"+e._s(e.t("files_sharing","Cancel"))+"\n\t\t\t\t")]),e._v(" "),i("NcButton",{attrs:{type:"primary"},on:{click:e.saveShare}},[e._v("\n\t\t\t\t\t"+e._s(e.shareButtonText)+"\n\t\t\t\t")])],1)])])}),[],!1,null,"28f6666d",null).exports;var Pe=s(25108);const Te={name:"SharingTab",components:{NcAvatar:l(),CollectionList:r.G,SharingEntryInternal:j,SharingEntrySimple:U,SharingInherited:Pt,SharingInput:ht,SharingLinkList:Gt,SharingList:ie,SharingDetailsTab:xe},mixins:[_],data:()=>({config:new u,deleteEvent:null,error:"",expirationInterval:null,loading:!0,fileInfo:null,reshare:null,sharedWithMe:{},shares:[],linkShares:[],sections:OCA.Sharing.ShareTabSections.getSections(),projectsEnabled:(0,c.j)("core","projects_enabled",!1),showSharingDetailsView:!1,shareDetailsData:{}}),computed:{isSharedWithMe(){return Object.keys(this.sharedWithMe).length>0},canReshare(){return!!(this.fileInfo.permissions&OC.PERMISSION_SHARE)||!!(this.reshare&&this.reshare.hasSharePermission&&this.config.isResharingAllowed)}},methods:{async update(t){this.fileInfo=t,this.resetState(),this.getShares()},async getShares(){try{this.loading=!0;const t=(0,o.generateOcsUrl)("apps/files_sharing/api/v1/shares"),e="json",i=(this.fileInfo.path+"/"+this.fileInfo.name).replace("//","/"),s=d.default.get(t,{params:{format:e,path:i,reshares:!0}}),a=d.default.get(t,{params:{format:e,path:i,shared_with_me:!0}}),[n,r]=await Promise.all([s,a]);this.loading=!1,this.processSharedWithMe(r),this.processShares(n)}catch(a){var e,i,s;null!==(e=a.response.data)&&void 0!==e&&null!==(i=e.ocs)&&void 0!==i&&null!==(s=i.meta)&&void 0!==s&&s.message?this.error=a.response.data.ocs.meta.message:this.error=t("files_sharing","Unable to load the shares list"),this.loading=!1,Pe.error("Error loading the shares list",a)}},resetState(){clearInterval(this.expirationInterval),this.loading=!0,this.error="",this.sharedWithMe={},this.shares=[],this.linkShares=[],this.showSharingDetailsView=!1,this.shareDetailsData={}},updateExpirationSubtitle(e){const i=moment(e.expireDate).unix();this.$set(this.sharedWithMe,"subtitle",t("files_sharing","Expires {relativetime}",{relativetime:OC.Util.relativeModifiedDate(1e3*i)})),moment().unix()>i&&(clearInterval(this.expirationInterval),this.$set(this.sharedWithMe,"subtitle",t("files_sharing","this share just expired.")))},processShares(t){let{data:e}=t;if(e.ocs&&e.ocs.data&&e.ocs.data.length>0){const t=e.ocs.data.map((t=>new f(t))).sort(((t,e)=>e.createdTime-t.createdTime));this.linkShares=t.filter((t=>t.type===this.SHARE_TYPES.SHARE_TYPE_LINK||t.type===this.SHARE_TYPES.SHARE_TYPE_EMAIL)),this.shares=t.filter((t=>t.type!==this.SHARE_TYPES.SHARE_TYPE_LINK&&t.type!==this.SHARE_TYPES.SHARE_TYPE_EMAIL)),Pe.debug("Processed",this.linkShares.length,"link share(s)"),Pe.debug("Processed",this.shares.length,"share(s)")}},processSharedWithMe(e){let{data:i}=e;if(i.ocs&&i.ocs.data&&i.ocs.data[0]){const e=new f(i),s=function(e){return e.type===A.D.SHARE_TYPE_GROUP?t("files_sharing","Shared with you and the group {group} by {owner}",{group:e.shareWithDisplayName,owner:e.ownerDisplayName},void 0,{escape:!1}):e.type===A.D.SHARE_TYPE_CIRCLE?t("files_sharing","Shared with you and {circle} by {owner}",{circle:e.shareWithDisplayName,owner:e.ownerDisplayName},void 0,{escape:!1}):e.type===A.D.SHARE_TYPE_ROOM?e.shareWithDisplayName?t("files_sharing","Shared with you and the conversation {conversation} by {owner}",{conversation:e.shareWithDisplayName,owner:e.ownerDisplayName},void 0,{escape:!1}):t("files_sharing","Shared with you in a conversation by {owner}",{owner:e.ownerDisplayName},void 0,{escape:!1}):t("files_sharing","Shared with you by {owner}",{owner:e.ownerDisplayName},void 0,{escape:!1})}(e),a=e.ownerDisplayName,n=e.owner;this.sharedWithMe={displayName:a,title:s,user:n},this.reshare=e,e.expireDate&&moment(e.expireDate).unix()>moment().unix()&&(this.updateExpirationSubtitle(e),this.expirationInterval=setInterval(this.updateExpirationSubtitle,1e4,e))}else this.fileInfo&&void 0!==this.fileInfo.shareOwnerId&&this.fileInfo.shareOwnerId!==OC.currentUser&&(this.sharedWithMe={displayName:this.fileInfo.shareOwner,title:t("files_sharing","Shared with you by {owner}",{owner:this.fileInfo.shareOwner},void 0,{escape:!1}),user:this.fileInfo.shareOwnerId})},addShare(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:()=>{};t.type===this.SHARE_TYPES.SHARE_TYPE_EMAIL?this.linkShares.unshift(t):this.shares.unshift(t),this.awaitForShare(t,e)},removeShare(t){const e=t.type===this.SHARE_TYPES.SHARE_TYPE_EMAIL||t.type===this.SHARE_TYPES.SHARE_TYPE_LINK?this.linkShares:this.shares,i=e.findIndex((e=>e.id===t.id));-1!==i&&e.splice(i,1)},awaitForShare(t,e){this.$nextTick((()=>{let i=this.$refs.shareList;t.type===this.SHARE_TYPES.SHARE_TYPE_EMAIL&&(i=this.$refs.linkShareList);const s=i.$children.find((e=>e.share===t));s&&e(s)}))},toggleShareDetailsView(t){t&&(this.shareDetailsData=t),this.showSharingDetailsView=!this.showSharingDetailsView}}},De=Te;var ke=s(57711),Re={};Re.styleTagTransform=L(),Re.setAttributes=R(),Re.insert=D().bind(null,"head"),Re.domAPI=P(),Re.insertStyleElement=N(),b()(ke.Z,Re),ke.Z&&ke.Z.locals&&ke.Z.locals;const Ie=(0,B.Z)(De,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"sharingTab",class:{"icon-loading":t.loading}},[t.error?e("div",{staticClass:"emptycontent",class:{emptyContentWithSections:t.sections.length>0}},[e("div",{staticClass:"icon icon-error"}),t._v(" "),e("h2",[t._v(t._s(t.error))])]):t._e(),t._v(" "),t.showSharingDetailsView?e("SharingDetailsTab",{attrs:{"file-info":t.shareDetailsData.fileInfo,share:t.shareDetailsData.share},on:{"close-sharing-details":t.toggleShareDetailsView,"add:share":t.addShare,"remove:share":t.removeShare}}):[e("div",{staticClass:"sharingTab__content"},[t.isSharedWithMe?e("SharingEntrySimple",t._b({staticClass:"sharing-entry__reshare",scopedSlots:t._u([{key:"avatar",fn:function(){return[e("NcAvatar",{staticClass:"sharing-entry__avatar",attrs:{user:t.sharedWithMe.user,"display-name":t.sharedWithMe.displayName}})]},proxy:!0}],null,!1,3197855346)},"SharingEntrySimple",t.sharedWithMe,!1)):t._e(),t._v(" "),t.loading?t._e():e("SharingInput",{attrs:{"can-reshare":t.canReshare,"file-info":t.fileInfo,"link-shares":t.linkShares,reshare:t.reshare,shares:t.shares},on:{"open-sharing-details":t.toggleShareDetailsView}}),t._v(" "),t.loading?t._e():e("SharingLinkList",{ref:"linkShareList",attrs:{"can-reshare":t.canReshare,"file-info":t.fileInfo,shares:t.linkShares},on:{"open-sharing-details":t.toggleShareDetailsView}}),t._v(" "),t.loading?t._e():e("SharingList",{ref:"shareList",attrs:{shares:t.shares,"file-info":t.fileInfo},on:{"open-sharing-details":t.toggleShareDetailsView}}),t._v(" "),t.canReshare&&!t.loading?e("SharingInherited",{attrs:{"file-info":t.fileInfo}}):t._e(),t._v(" "),e("SharingEntryInternal",{attrs:{"file-info":t.fileInfo}}),t._v(" "),t.projectsEnabled&&t.fileInfo?e("CollectionList",{attrs:{id:"".concat(t.fileInfo.id),type:"file",name:t.fileInfo.name}}):t._e()],1),t._v(" "),t._l(t.sections,(function(i,s){return e("div",{key:s,ref:"section-"+s,refInFor:!0,staticClass:"sharingTab__additionalContent"},[e(i(t.$refs["section-"+s],t.fileInfo),{tag:"component",attrs:{"file-info":t.fileInfo}})],1)}))]],2)}),[],!1,null,"7e41779f",null).exports;var Ne=s(25108);var Oe=s(25108);var Le=s(25108);var Ye=s(44582);window.OCA.Sharing||(window.OCA.Sharing={}),Object.assign(window.OCA.Sharing,{ShareSearch:new class{constructor(){var t,e,i;t=this,i=void 0,(e=function(t){var e=function(t,e){if("object"!=typeof t||null===t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var s=i.call(t,"string");if("object"!=typeof s)return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==typeof e?e:String(e)}(e="_state"))in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,this._state={},this._state.results=[],Ne.debug("OCA.Sharing.ShareSearch initialized")}get state(){return this._state}addNewResult(t){return""!==t.displayName.trim()&&"function"==typeof t.handler?(this._state.results.push(t),!0):(Ne.error("Invalid search result provided",t),!1)}}}),Object.assign(window.OCA.Sharing,{ExternalLinkActions:new class{constructor(){var t,e,i;t=this,i=void 0,(e=function(t){var e=function(t,e){if("object"!=typeof t||null===t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var s=i.call(t,"string");if("object"!=typeof s)return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==typeof e?e:String(e)}(e="_state"))in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,this._state={},this._state.actions=[],Oe.debug("OCA.Sharing.ExternalLinkActions initialized")}get state(){return this._state}registerAction(t){return OC.debug&&Oe.warn("OCA.Sharing.ExternalLinkActions is deprecated, use OCA.Sharing.ExternalShareAction instead"),"object"==typeof t&&t.icon&&t.name&&t.url?(this._state.actions.push(t),!0):(Oe.error("Invalid action provided",t),!1)}}}),Object.assign(window.OCA.Sharing,{ExternalShareActions:new class{constructor(){var t,e,i;t=this,i=void 0,(e=function(t){var e=function(t,e){if("object"!=typeof t||null===t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var s=i.call(t,"string");if("object"!=typeof s)return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==typeof e?e:String(e)}(e="_state"))in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,this._state={},this._state.actions=[],Le.debug("OCA.Sharing.ExternalShareActions initialized")}get state(){return this._state}registerAction(t){return"object"==typeof t&&"string"==typeof t.id&&"function"==typeof t.data&&Array.isArray(t.shareType)&&"object"==typeof t.handlers&&Object.values(t.handlers).every((t=>"function"==typeof t))?this._state.actions.findIndex((e=>e.id===t.id))>-1?(Le.error("An action with the same id ".concat(t.id," already exists"),t),!1):(this._state.actions.push(t),!0):(Le.error("Invalid action provided",t),!1)}}}),Object.assign(window.OCA.Sharing,{ShareTabSections:new class{constructor(){var t,e,i;t=this,i=void 0,(e=function(t){var e=function(t,e){if("object"!=typeof t||null===t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var s=i.call(t,"string");if("object"!=typeof s)return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==typeof e?e:String(e)}(e="_sections"))in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,this._sections=[]}registerSection(t){this._sections.push(t)}getSections(){return this._sections}}}),a.default.prototype.t=n.Iu,a.default.prototype.n=n.uN;const He=a.default.extend(Ie);let Be=null;window.addEventListener("DOMContentLoaded",(function(){OCA.Files&&OCA.Files.Sidebar&&OCA.Files.Sidebar.registerTab(new OCA.Files.Sidebar.Tab({id:"sharing",name:(0,n.Iu)("files_sharing","Sharing"),iconSvg:Ye,async mount(t,e,i){Be&&Be.$destroy(),Be=new He({parent:i}),await Be.update(e),Be.$mount(t)},update(t){Be.update(t)},destroy(){Be.$destroy(),Be=null}}))}))},82674:(t,e,i)=>{i.d(e,{Z:()=>o});var s=i(87537),a=i.n(s),n=i(23645),r=i.n(n)()(a());r.push([t.id,".sharing-entry[data-v-b6613238]{display:flex;align-items:center;height:44px}.sharing-entry__summary[data-v-b6613238]{padding:8px;display:flex;flex-direction:column;justify-content:center;width:80%;min-width:80%}.sharing-entry__summary__desc[data-v-b6613238]{display:inline-block;padding-bottom:0;line-height:1.2em;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.sharing-entry__summary__desc p[data-v-b6613238],.sharing-entry__summary__desc small[data-v-b6613238]{color:var(--color-text-maxcontrast)}.sharing-entry__summary__desc-unique[data-v-b6613238]{color:var(--color-text-maxcontrast)}","",{version:3,sources:["webpack://./apps/files_sharing/src/components/SharingEntry.vue"],names:[],mappings:"AACA,gCACC,YAAA,CACA,kBAAA,CACA,WAAA,CAEA,yCACC,WAAA,CACA,YAAA,CACA,qBAAA,CACA,sBAAA,CACA,SAAA,CACA,aAAA,CAEA,+CACC,oBAAA,CACA,gBAAA,CACA,iBAAA,CACA,kBAAA,CACA,eAAA,CACA,sBAAA,CAEA,sGAEC,mCAAA,CAGD,sDACC,mCAAA",sourcesContent:["\n.sharing-entry {\n\tdisplay: flex;\n\talign-items: center;\n\theight: 44px;\n\n\t&__summary {\n\t\tpadding: 8px;\n\t\tdisplay: flex;\n\t\tflex-direction: column;\n\t\tjustify-content: center;\n\t\twidth: 80%;\n\t\tmin-width: 80%;\n\n\t\t&__desc {\n\t\t\tdisplay: inline-block;\n\t\t\tpadding-bottom: 0;\n\t\t\tline-height: 1.2em;\n\t\t\twhite-space: nowrap;\n\t\t\toverflow: hidden;\n\t\t\ttext-overflow: ellipsis;\n\n\t\t\tp,\n\t\t\tsmall {\n\t\t\t\tcolor: var(--color-text-maxcontrast);\n\t\t\t}\n\n\t\t\t&-unique {\n\t\t\t\tcolor: var(--color-text-maxcontrast);\n\t\t\t}\n\t\t}\n\t}\n\n}\n"],sourceRoot:""}]);const o=r},72021:(t,e,i)=>{i.d(e,{Z:()=>o});var s=i(87537),a=i.n(s),n=i(23645),r=i.n(n)()(a());r.push([t.id,".sharing-entry[data-v-283ca89e]{display:flex;align-items:center;height:44px}.sharing-entry__desc[data-v-283ca89e]{display:flex;flex-direction:column;justify-content:space-between;padding:8px;padding-left:10px;line-height:1.2em}.sharing-entry__desc p[data-v-283ca89e]{color:var(--color-text-maxcontrast)}.sharing-entry__actions[data-v-283ca89e]{margin-left:auto}","",{version:3,sources:["webpack://./apps/files_sharing/src/components/SharingEntryInherited.vue"],names:[],mappings:"AACA,gCACC,YAAA,CACA,kBAAA,CACA,WAAA,CACA,sCACC,YAAA,CACA,qBAAA,CACA,6BAAA,CACA,WAAA,CACA,iBAAA,CACA,iBAAA,CACA,wCACC,mCAAA,CAGF,yCACC,gBAAA",sourcesContent:["\n.sharing-entry {\n\tdisplay: flex;\n\talign-items: center;\n\theight: 44px;\n\t&__desc {\n\t\tdisplay: flex;\n\t\tflex-direction: column;\n\t\tjustify-content: space-between;\n\t\tpadding: 8px;\n\t\tpadding-left: 10px;\n\t\tline-height: 1.2em;\n\t\tp {\n\t\t\tcolor: var(--color-text-maxcontrast);\n\t\t}\n\t}\n\t&__actions {\n\t\tmargin-left: auto;\n\t}\n}\n"],sourceRoot:""}]);const o=r},2256:(t,e,i)=>{i.d(e,{Z:()=>o});var s=i(87537),a=i.n(s),n=i(23645),r=i.n(n)()(a());r.push([t.id,".sharing-entry__internal .avatar-external[data-v-71a426be]{width:32px;height:32px;line-height:32px;font-size:18px;background-color:var(--color-text-maxcontrast);border-radius:50%;flex-shrink:0}.sharing-entry__internal .icon-checkmark-color[data-v-71a426be]{opacity:1}","",{version:3,sources:["webpack://./apps/files_sharing/src/components/SharingEntryInternal.vue"],names:[],mappings:"AAEC,2DACC,UAAA,CACA,WAAA,CACA,gBAAA,CACA,cAAA,CACA,8CAAA,CACA,iBAAA,CACA,aAAA,CAED,gEACC,SAAA",sourcesContent:["\n.sharing-entry__internal {\n\t.avatar-external {\n\t\twidth: 32px;\n\t\theight: 32px;\n\t\tline-height: 32px;\n\t\tfont-size: 18px;\n\t\tbackground-color: var(--color-text-maxcontrast);\n\t\tborder-radius: 50%;\n\t\tflex-shrink: 0;\n\t}\n\t.icon-checkmark-color {\n\t\topacity: 1;\n\t}\n}\n"],sourceRoot:""}]);const o=r},61207:(t,e,i)=>{i.d(e,{Z:()=>o});var s=i(87537),a=i.n(s),n=i(23645),r=i.n(n)()(a());r.push([t.id,".sharing-entry[data-v-12bdf14e]{display:flex;align-items:center;min-height:44px}.sharing-entry__summary[data-v-12bdf14e]{padding:8px;padding-left:10px;display:flex;justify-content:space-between;width:80%;min-width:80%}.sharing-entry__summary__desc[data-v-12bdf14e]{display:flex;flex-direction:column;line-height:1.2em}.sharing-entry__summary__desc p[data-v-12bdf14e]{color:var(--color-text-maxcontrast)}.sharing-entry__summary__desc__title[data-v-12bdf14e]{text-overflow:ellipsis;overflow:hidden;white-space:nowrap}.sharing-entry:not(.sharing-entry--share) .sharing-entry__actions .new-share-link[data-v-12bdf14e]{border-top:1px solid var(--color-border)}.sharing-entry[data-v-12bdf14e] .avatar-link-share{background-color:var(--color-primary-element)}.sharing-entry .sharing-entry__action--public-upload[data-v-12bdf14e]{border-bottom:1px solid var(--color-border)}.sharing-entry__loading[data-v-12bdf14e]{width:44px;height:44px;margin:0;padding:14px;margin-left:auto}.sharing-entry .action-item~.action-item[data-v-12bdf14e],.sharing-entry .action-item~.sharing-entry__loading[data-v-12bdf14e]{margin-left:0}.sharing-entry .icon-checkmark-color[data-v-12bdf14e]{opacity:1}","",{version:3,sources:["webpack://./apps/files_sharing/src/components/SharingEntryLink.vue"],names:[],mappings:"AACA,gCACC,YAAA,CACA,kBAAA,CACA,eAAA,CAEA,yCACC,WAAA,CACA,iBAAA,CACA,YAAA,CACA,6BAAA,CACA,SAAA,CACA,aAAA,CAED,+CACC,YAAA,CACA,qBAAA,CACA,iBAAA,CAEA,iDACC,mCAAA,CAGD,sDACC,sBAAA,CACA,eAAA,CACA,kBAAA,CAUD,mGACC,wCAAA,CAIF,mDACC,6CAAA,CAGD,sEACC,2CAAA,CAGD,yCACC,UAAA,CACA,WAAA,CACA,QAAA,CACA,YAAA,CACA,gBAAA,CAOA,+HAEC,aAAA,CAIF,sDACC,SAAA",sourcesContent:["\n.sharing-entry {\n\tdisplay: flex;\n\talign-items: center;\n\tmin-height: 44px;\n\n\t&__summary {\n\t\tpadding: 8px;\n\t\tpadding-left: 10px;\n\t\tdisplay: flex;\n\t\tjustify-content: space-between;\n\t\twidth: 80%;\n\t\tmin-width: 80%;\n\n\t&__desc {\n\t\tdisplay: flex;\n\t\tflex-direction: column;\n\t\tline-height: 1.2em;\n\n\t\tp {\n\t\t\tcolor: var(--color-text-maxcontrast);\n\t\t}\n\n\t\t&__title {\n\t\t\ttext-overflow: ellipsis;\n\t\t\toverflow: hidden;\n\t\t\twhite-space: nowrap;\n\t\t}\n\t  }\n\n\t  &__copy {\n\n\t  }\n\t}\n\n\t&:not(.sharing-entry--share) &__actions {\n\t\t.new-share-link {\n\t\t\tborder-top: 1px solid var(--color-border);\n\t\t}\n\t}\n\n\t::v-deep .avatar-link-share {\n\t\tbackground-color: var(--color-primary-element);\n\t}\n\n\t.sharing-entry__action--public-upload {\n\t\tborder-bottom: 1px solid var(--color-border);\n\t}\n\n\t&__loading {\n\t\twidth: 44px;\n\t\theight: 44px;\n\t\tmargin: 0;\n\t\tpadding: 14px;\n\t\tmargin-left: auto;\n\t}\n\n\t// put menus to the left\n\t// but only the first one\n\t.action-item {\n\n\t\t~.action-item,\n\t\t~.sharing-entry__loading {\n\t\t\tmargin-left: 0;\n\t\t}\n\t}\n\n\t.icon-checkmark-color {\n\t\topacity: 1;\n\t}\n}\n"],sourceRoot:""}]);const o=r},96021:(t,e,i)=>{i.d(e,{Z:()=>o});var s=i(87537),a=i.n(s),n=i(23645),r=i.n(n)()(a());r.push([t.id,".share-select[data-v-d960cabe]{position:relative;cursor:pointer}.share-select .trigger-text[data-v-d960cabe]{display:flex;flex-direction:row;align-items:center;font-size:12.5px;gap:2px;color:var(--color-primary-element)}.share-select .share-select-dropdown[data-v-d960cabe]{position:absolute;display:flex;flex-direction:column;top:100%;left:0;background-color:var(--color-main-background);border-radius:8px;box-shadow:0 2px 4px rgba(0,0,0,.2);border:1px solid var(--color-border);padding:4px 0;z-index:1}.share-select .share-select-dropdown .dropdown-item[data-v-d960cabe]{padding:8px;font-size:12px;background:none;border:none;border-radius:0;font:inherit;cursor:pointer;color:inherit;outline:none;width:100%;white-space:nowrap;text-align:left}.share-select .share-select-dropdown .dropdown-item[data-v-d960cabe]:hover{background-color:var(--color-background-dark)}.share-select .share-select-dropdown .dropdown-item.selected[data-v-d960cabe]{background-color:var(--color-background-dark)}.share-select .share-select-dropdown[data-v-d960cabe]{max-height:0;overflow:hidden;transition:max-height .3s ease}.share-select.active .share-select-dropdown[data-v-d960cabe]{max-height:200px}","",{version:3,sources:["webpack://./apps/files_sharing/src/components/SharingEntryQuickShareSelect.vue"],names:[],mappings:"AACA,+BACC,iBAAA,CACA,cAAA,CAEA,6CACC,YAAA,CACA,kBAAA,CACA,kBAAA,CACA,gBAAA,CACA,OAAA,CACA,kCAAA,CAGD,sDACC,iBAAA,CACA,YAAA,CACA,qBAAA,CACA,QAAA,CACA,MAAA,CACA,6CAAA,CACA,iBAAA,CACA,mCAAA,CACA,oCAAA,CACA,aAAA,CACA,SAAA,CAEA,qEACC,WAAA,CACA,cAAA,CACA,eAAA,CACA,WAAA,CACA,eAAA,CACA,YAAA,CACA,cAAA,CACA,aAAA,CACA,YAAA,CACA,UAAA,CACA,kBAAA,CACA,eAAA,CAEA,2EACC,6CAAA,CAGD,8EACC,6CAAA,CAMH,sDACC,YAAA,CACA,eAAA,CACA,8BAAA,CAGD,6DACC,gBAAA",sourcesContent:["\n.share-select {\n\tposition: relative;\n\tcursor: pointer;\n\n\t.trigger-text {\n\t\tdisplay: flex;\n\t\tflex-direction: row;\n\t\talign-items: center;\n\t\tfont-size: 12.5px;\n\t\tgap: 2px;\n\t\tcolor: var(--color-primary-element);\n\t}\n\n\t.share-select-dropdown {\n\t\tposition: absolute;\n\t\tdisplay: flex;\n\t\tflex-direction: column;\n\t\ttop: 100%;\n\t\tleft: 0;\n\t\tbackground-color: var(--color-main-background);\n\t\tborder-radius: 8px;\n\t\tbox-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);\n\t\tborder: 1px solid var(--color-border);\n\t\tpadding: 4px 0;\n\t\tz-index: 1;\n\n\t\t.dropdown-item {\n\t\t\tpadding: 8px;\n\t\t\tfont-size: 12px;\n\t\t\tbackground: none;\n\t\t\tborder: none;\n\t\t\tborder-radius: 0;\n\t\t\tfont: inherit;\n\t\t\tcursor: pointer;\n\t\t\tcolor: inherit;\n\t\t\toutline: none;\n\t\t\twidth: 100%;\n\t\t\twhite-space: nowrap;\n\t\t\ttext-align: left;\n\n\t\t\t&:hover {\n\t\t\t\tbackground-color: var(--color-background-dark);\n\t\t\t}\n\n\t\t\t&.selected {\n\t\t\t\tbackground-color: var(--color-background-dark);\n\t\t\t}\n\t\t}\n\t}\n\n\t/* Optional: Add a transition effect for smoother dropdown animation */\n\t.share-select-dropdown {\n\t\tmax-height: 0;\n\t\toverflow: hidden;\n\t\ttransition: max-height 0.3s ease;\n\t}\n\n\t&.active .share-select-dropdown {\n\t\tmax-height: 200px;\n\t\t/* Adjust the value to your desired height */\n\t}\n}\n"],sourceRoot:""}]);const o=r},66452:(t,e,i)=>{i.d(e,{Z:()=>o});var s=i(87537),a=i.n(s),n=i(23645),r=i.n(n)()(a());r.push([t.id,".sharing-entry[data-v-1852ea78]{display:flex;align-items:center;min-height:44px}.sharing-entry__desc[data-v-1852ea78]{padding:8px;padding-left:10px;line-height:1.2em;position:relative;flex:1 1;min-width:0}.sharing-entry__desc p[data-v-1852ea78]{color:var(--color-text-maxcontrast)}.sharing-entry__title[data-v-1852ea78]{white-space:nowrap;text-overflow:ellipsis;overflow:hidden;max-width:inherit}.sharing-entry__actions[data-v-1852ea78]{margin-left:auto !important}","",{version:3,sources:["webpack://./apps/files_sharing/src/components/SharingEntrySimple.vue"],names:[],mappings:"AACA,gCACC,YAAA,CACA,kBAAA,CACA,eAAA,CACA,sCACC,WAAA,CACA,iBAAA,CACA,iBAAA,CACA,iBAAA,CACA,QAAA,CACA,WAAA,CACA,wCACC,mCAAA,CAGF,uCACC,kBAAA,CACA,sBAAA,CACA,eAAA,CACA,iBAAA,CAED,yCACC,2BAAA",sourcesContent:["\n.sharing-entry {\n\tdisplay: flex;\n\talign-items: center;\n\tmin-height: 44px;\n\t&__desc {\n\t\tpadding: 8px;\n\t\tpadding-left: 10px;\n\t\tline-height: 1.2em;\n\t\tposition: relative;\n\t\tflex: 1 1;\n\t\tmin-width: 0;\n\t\tp {\n\t\t\tcolor: var(--color-text-maxcontrast);\n\t\t}\n\t}\n\t&__title {\n\t\twhite-space: nowrap;\n\t\ttext-overflow: ellipsis;\n\t\toverflow: hidden;\n\t\tmax-width: inherit;\n\t}\n\t&__actions {\n\t\tmargin-left: auto !important;\n\t}\n}\n"],sourceRoot:""}]);const o=r},24764:(t,e,i)=>{i.d(e,{Z:()=>o});var s=i(87537),a=i.n(s),n=i(23645),r=i.n(n)()(a());r.push([t.id,".sharing-search{display:flex;flex-direction:column;margin-bottom:4px}.sharing-search label[for=sharing-search-input]{margin-bottom:2px}.sharing-search__input{width:100%;margin:10px 0}.vs__dropdown-menu span[lookup] .avatardiv{background-image:var(--icon-search-white);background-repeat:no-repeat;background-position:center;background-color:var(--color-text-maxcontrast) !important}.vs__dropdown-menu span[lookup] .avatardiv div{display:none}","",{version:3,sources:["webpack://./apps/files_sharing/src/components/SharingInput.vue"],names:[],mappings:"AACA,gBACC,YAAA,CACA,qBAAA,CACA,iBAAA,CAEA,gDACC,iBAAA,CAGD,uBACC,UAAA,CACA,aAAA,CAOA,2CACC,yCAAA,CACA,2BAAA,CACA,0BAAA,CACA,yDAAA,CACA,+CACC,YAAA",sourcesContent:['\n.sharing-search {\n\tdisplay: flex;\n\tflex-direction: column;\n\tmargin-bottom: 4px;\n\n\tlabel[for="sharing-search-input"] {\n\t\tmargin-bottom: 2px;\n\t}\n\n\t&__input {\n\t\twidth: 100%;\n\t\tmargin: 10px 0;\n\t}\n}\n\n.vs__dropdown-menu {\n\t// properly style the lookup entry\n\tspan[lookup] {\n\t\t.avatardiv {\n\t\t\tbackground-image: var(--icon-search-white);\n\t\t\tbackground-repeat: no-repeat;\n\t\t\tbackground-position: center;\n\t\t\tbackground-color: var(--color-text-maxcontrast) !important;\n\t\t\tdiv {\n\t\t\t\tdisplay: none;\n\t\t\t}\n\t\t}\n\t}\n}\n'],sourceRoot:""}]);const o=r},78211:(t,e,i)=>{i.d(e,{Z:()=>o});var s=i(87537),a=i.n(s),n=i(23645),r=i.n(n)()(a());r.push([t.id,".sharingTabDetailsView[data-v-28f6666d]{display:flex;flex-direction:column;width:100%;margin:0 auto;position:relative;height:100%;overflow:hidden}.sharingTabDetailsView__header[data-v-28f6666d]{display:flex;align-items:center;box-sizing:border-box;margin:.2em}.sharingTabDetailsView__header span[data-v-28f6666d]{display:flex;align-items:center}.sharingTabDetailsView__header span h1[data-v-28f6666d]{font-size:15px;padding-left:.3em}.sharingTabDetailsView__wrapper[data-v-28f6666d]{overflow:scroll;flex-shrink:1;padding:4px;padding-right:12px}.sharingTabDetailsView__quick-permissions[data-v-28f6666d]{display:flex;justify-content:center;width:100%;margin:0 auto;border-radius:0}.sharingTabDetailsView__quick-permissions div[data-v-28f6666d]{width:100%}.sharingTabDetailsView__quick-permissions div span[data-v-28f6666d]{width:100%}.sharingTabDetailsView__quick-permissions div span span[data-v-28f6666d]:nth-child(1){align-items:center;justify-content:center;color:var(--color-primary-element);padding:.1em}.sharingTabDetailsView__quick-permissions div span[data-v-28f6666d] label{display:flex;flex-wrap:wrap}.sharingTabDetailsView__quick-permissions div span[data-v-28f6666d] label span{display:flex}.sharingTabDetailsView__quick-permissions div span[data-v-28f6666d] label span:first-of-type{flex:10%}.sharingTabDetailsView__quick-permissions div span[data-v-28f6666d] label span:last-of-type{flex:90%}.sharingTabDetailsView__quick-permissions div span[data-v-28f6666d] label small{padding-left:10%;flex-basis:100% !important}.sharingTabDetailsView__advanced-control[data-v-28f6666d]{width:100%}.sharingTabDetailsView__advanced-control button[data-v-28f6666d]{margin-top:.5em}.sharingTabDetailsView__advanced[data-v-28f6666d]{width:100%;margin-bottom:.5em;text-align:left;padding-left:0}.sharingTabDetailsView__advanced section textarea[data-v-28f6666d],.sharingTabDetailsView__advanced section div.mx-datepicker[data-v-28f6666d]{width:100%}.sharingTabDetailsView__advanced section textarea[data-v-28f6666d]{height:80px;margin:0}.sharingTabDetailsView__advanced section span[data-v-28f6666d] label{background-color:initial !important;border:none !important}.sharingTabDetailsView__advanced section section.custom-permissions-group[data-v-28f6666d]{padding-left:1.5em}.sharingTabDetailsView__footer[data-v-28f6666d]{width:100%;display:flex;position:sticky;bottom:0;flex-direction:column;justify-content:space-between;align-items:flex-start;background:linear-gradient(to bottom, rgba(255, 255, 255, 0), var(--color-main-background))}.sharingTabDetailsView__footer>button[data-v-28f6666d]:first-child{color:#df0707;background-color:#f5f5f5}.sharingTabDetailsView__footer .button-group[data-v-28f6666d]{display:flex;justify-content:space-between;width:100%;margin-top:16px}.sharingTabDetailsView__footer .button-group button[data-v-28f6666d]{margin-left:16px}.sharingTabDetailsView__footer .button-group button[data-v-28f6666d]:first-child{margin-left:0}","",{version:3,sources:["webpack://./apps/files_sharing/src/views/SharingDetailsTab.vue"],names:[],mappings:"AACA,wCACC,YAAA,CACA,qBAAA,CACA,UAAA,CACA,aAAA,CACA,iBAAA,CACA,WAAA,CACA,eAAA,CAEA,gDACC,YAAA,CACA,kBAAA,CACA,qBAAA,CACA,WAAA,CAEA,qDACC,YAAA,CACA,kBAAA,CAEA,wDACC,cAAA,CACA,iBAAA,CAMH,iDACC,eAAA,CACA,aAAA,CACA,WAAA,CACA,kBAAA,CAGD,2DACC,YAAA,CACA,sBAAA,CACA,UAAA,CACA,aAAA,CACA,eAAA,CAEA,+DACC,UAAA,CAEA,oEACC,UAAA,CAEA,sFACC,kBAAA,CACA,sBAAA,CACA,kCAAA,CACA,YAAA,CAGD,0EACC,YAAA,CACA,cAAA,CAEA,+EACC,YAAA,CAEA,6FACC,QAAA,CAGD,4FACC,QAAA,CAIF,gFACC,gBAAA,CACA,0BAAA,CASL,0DACC,UAAA,CAEA,iEACC,eAAA,CAKF,kDACC,UAAA,CACA,kBAAA,CACA,eAAA,CACA,cAAA,CAIC,+IAEC,UAAA,CAGD,mEACC,WAAA,CACA,QAAA,CAaA,qEACC,mCAAA,CACA,sBAAA,CAIF,2FACC,kBAAA,CAKH,gDACC,UAAA,CACA,YAAA,CACA,eAAA,CACA,QAAA,CACA,qBAAA,CACA,6BAAA,CACA,sBAAA,CACA,2FAAA,CAEA,mEACC,aAAA,CACA,wBAAA,CAGD,8DACC,YAAA,CACA,6BAAA,CACA,UAAA,CACA,eAAA,CAEA,qEACC,gBAAA,CAEA,iFACC,aAAA",sourcesContent:["\n.sharingTabDetailsView {\n\tdisplay: flex;\n\tflex-direction: column;\n\twidth: 100%;\n\tmargin: 0 auto;\n\tposition: relative;\n\theight: 100%;\n\toverflow: hidden;\n\n\t&__header {\n\t\tdisplay: flex;\n\t\talign-items: center;\n\t\tbox-sizing: border-box;\n\t\tmargin: 0.2em;\n\n\t\tspan {\n\t\t\tdisplay: flex;\n\t\t\talign-items: center;\n\n\t\t\th1 {\n\t\t\t\tfont-size: 15px;\n\t\t\t\tpadding-left: 0.3em;\n\t\t\t}\n\n\t\t}\n\t}\n\n\t&__wrapper {\n\t\toverflow: scroll;\n\t\tflex-shrink: 1;\n\t\tpadding: 4px;\n\t\tpadding-right: 12px;\n\t}\n\n\t&__quick-permissions {\n\t\tdisplay: flex;\n\t\tjustify-content: center;\n\t\twidth: 100%;\n\t\tmargin: 0 auto;\n\t\tborder-radius: 0;\n\n\t\tdiv {\n\t\t\twidth: 100%;\n\n\t\t\tspan {\n\t\t\t\twidth: 100%;\n\n\t\t\t\tspan:nth-child(1) {\n\t\t\t\t\talign-items: center;\n\t\t\t\t\tjustify-content: center;\n\t\t\t\t\tcolor: var(--color-primary-element);\n\t\t\t\t\tpadding: 0.1em;\n\t\t\t\t}\n\n\t\t\t\t::v-deep label {\n\t\t\t\t\tdisplay: flex;\n\t\t\t\t\tflex-wrap: wrap;\n\n\t\t\t\t\tspan {\n\t\t\t\t\t\tdisplay: flex;\n\n\t\t\t\t\t\t&:first-of-type {\n\t\t\t\t\t\t\tflex: 10%;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t&:last-of-type {\n\t\t\t\t\t\t\tflex: 90%\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tsmall {\n\t\t\t\t\t\tpadding-left: 10%;\n\t\t\t\t\t\tflex-basis: 100% !important;\n\t\t\t\t\t}\n\n\t\t\t\t}\n\t\t\t}\n\n\t\t}\n\t}\n\n\t&__advanced-control {\n\t\twidth: 100%;\n\n\t\tbutton {\n\t\t\tmargin-top: 0.5em;\n\t\t}\n\n\t}\n\n\t&__advanced {\n\t\twidth: 100%;\n\t\tmargin-bottom: 0.5em;\n\t\ttext-align: left;\n\t\tpadding-left: 0;\n\n\t\tsection {\n\n\t\t\ttextarea,\n\t\t\tdiv.mx-datepicker {\n\t\t\t\twidth: 100%;\n\t\t\t}\n\n\t\t\ttextarea {\n\t\t\t\theight: 80px;\n\t\t\t\tmargin: 0;\n\t\t\t}\n\n\t\t\t/*\n              The following style is applied out of the component's scope\n              to remove padding from the label.checkbox-radio-switch__label,\n              which is used to group radio checkbox items. The use of ::v-deep\n              ensures that the padding is modified without being affected by\n              the component's scoping.\n              Without this achieving left alignment for the checkboxes would not\n              be possible.\n            */\n\t\t\tspan {\n\t\t\t\t::v-deep label {\n\t\t\t\t\tbackground-color: initial !important;\n\t\t\t\t\tborder: none !important;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tsection.custom-permissions-group {\n\t\t\t\tpadding-left: 1.5em;\n\t\t\t}\n\t\t}\n\t}\n\n\t&__footer {\n\t\twidth: 100%;\n\t\tdisplay: flex;\n\t\tposition: sticky;\n\t\tbottom: 0;\n\t\tflex-direction: column;\n\t\tjustify-content: space-between;\n\t\talign-items: flex-start;\n\t\tbackground: linear-gradient(to bottom, rgba(255, 255, 255, 0), var(--color-main-background));\n\n\t\t>button:first-child {\n\t\t\tcolor: rgb(223, 7, 7);\n\t\t\tbackground-color: #f5f5f5;\n\t\t}\n\n\t\t.button-group {\n\t\t\tdisplay: flex;\n\t\t\tjustify-content: space-between;\n\t\t\twidth: 100%;\n\t\t\tmargin-top: 16px;\n\n\t\t\tbutton {\n\t\t\t\tmargin-left: 16px;\n\n\t\t\t\t&:first-child {\n\t\t\t\t\tmargin-left: 0;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n}\n"],sourceRoot:""}]);const o=r},84772:(t,e,i)=>{i.d(e,{Z:()=>o});var s=i(87537),a=i.n(s),n=i(23645),r=i.n(n)()(a());r.push([t.id,".sharing-entry__inherited .avatar-shared[data-v-05b67dc8]{width:32px;height:32px;line-height:32px;font-size:18px;background-color:var(--color-text-maxcontrast);border-radius:50%;flex-shrink:0}","",{version:3,sources:["webpack://./apps/files_sharing/src/views/SharingInherited.vue"],names:[],mappings:"AAEC,0DACC,UAAA,CACA,WAAA,CACA,gBAAA,CACA,cAAA,CACA,8CAAA,CACA,iBAAA,CACA,aAAA",sourcesContent:["\n.sharing-entry__inherited {\n\t.avatar-shared {\n\t\twidth: 32px;\n\t\theight: 32px;\n\t\tline-height: 32px;\n\t\tfont-size: 18px;\n\t\tbackground-color: var(--color-text-maxcontrast);\n\t\tborder-radius: 50%;\n\t\tflex-shrink: 0;\n\t}\n}\n"],sourceRoot:""}]);const o=r},57711:(t,e,i)=>{i.d(e,{Z:()=>o});var s=i(87537),a=i.n(s),n=i(23645),r=i.n(n)()(a());r.push([t.id,".emptyContentWithSections[data-v-7e41779f]{margin:1rem auto}.sharingTab[data-v-7e41779f]{position:relative;height:100%}.sharingTab__content[data-v-7e41779f]{padding:0 6px}.sharingTab__additionalContent[data-v-7e41779f]{margin:44px 0}","",{version:3,sources:["webpack://./apps/files_sharing/src/views/SharingTab.vue"],names:[],mappings:"AACA,2CACC,gBAAA,CAGD,6BACC,iBAAA,CACA,WAAA,CAEA,sCACC,aAAA,CAGD,gDACC,aAAA",sourcesContent:["\n.emptyContentWithSections {\n\tmargin: 1rem auto;\n}\n\n.sharingTab {\n\tposition: relative;\n\theight: 100%;\n\n\t&__content {\n\t\tpadding: 0 6px;\n\t}\n\n\t&__additionalContent {\n\t\tmargin: 44px 0;\n\t}\n}\n"],sourceRoot:""}]);const o=r}},n={};function r(t){var e=n[t];if(void 0!==e)return e.exports;var i=n[t]={id:t,loaded:!1,exports:{}};return a[t].call(i.exports,i,i.exports,r),i.loaded=!0,i.exports}r.m=a,e=[],r.O=(t,i,s,a)=>{if(!i){var n=1/0;for(d=0;d<e.length;d++){i=e[d][0],s=e[d][1],a=e[d][2];for(var o=!0,h=0;h<i.length;h++)(!1&a||n>=a)&&Object.keys(r.O).every((t=>r.O[t](i[h])))?i.splice(h--,1):(o=!1,a<n&&(n=a));if(o){e.splice(d--,1);var l=s();void 0!==l&&(t=l)}}return t}a=a||0;for(var d=e.length;d>0&&e[d-1][2]>a;d--)e[d]=e[d-1];e[d]=[i,s,a]},r.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return r.d(e,{a:e}),e},r.d=(t,e)=>{for(var i in e)r.o(e,i)&&!r.o(t,i)&&Object.defineProperty(t,i,{enumerable:!0,get:e[i]})},r.f={},r.e=t=>Promise.all(Object.keys(r.f).reduce(((e,i)=>(r.f[i](t,e),e)),[])),r.u=t=>t+"-"+t+".js?v=00434e4baa0d8e7b79f1",r.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),r.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),i={},s="nextcloud:",r.l=(t,e,a,n)=>{if(i[t])i[t].push(e);else{var o,h;if(void 0!==a)for(var l=document.getElementsByTagName("script"),d=0;d<l.length;d++){var c=l[d];if(c.getAttribute("src")==t||c.getAttribute("data-webpack")==s+a){o=c;break}}o||(h=!0,(o=document.createElement("script")).charset="utf-8",o.timeout=120,r.nc&&o.setAttribute("nonce",r.nc),o.setAttribute("data-webpack",s+a),o.src=t),i[t]=[e];var p=(e,s)=>{o.onerror=o.onload=null,clearTimeout(u);var a=i[t];if(delete i[t],o.parentNode&&o.parentNode.removeChild(o),a&&a.forEach((t=>t(s))),e)return e(s)},u=setTimeout(p.bind(null,void 0,{type:"timeout",target:o}),12e4);o.onerror=p.bind(null,o.onerror),o.onload=p.bind(null,o.onload),h&&document.head.appendChild(o)}},r.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.nmd=t=>(t.paths=[],t.children||(t.children=[]),t),r.j=7870,(()=>{var t;r.g.importScripts&&(t=r.g.location+"");var e=r.g.document;if(!t&&e&&(e.currentScript&&(t=e.currentScript.src),!t)){var i=e.getElementsByTagName("script");i.length&&(t=i[i.length-1].src)}if(!t)throw new Error("Automatic publicPath is not supported in this browser");t=t.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),r.p=t})(),(()=>{r.b=document.baseURI||self.location.href;var t={7870:0};r.f.j=(e,i)=>{var s=r.o(t,e)?t[e]:void 0;if(0!==s)if(s)i.push(s[2]);else{var a=new Promise(((i,a)=>s=t[e]=[i,a]));i.push(s[2]=a);var n=r.p+r.u(e),o=new Error;r.l(n,(i=>{if(r.o(t,e)&&(0!==(s=t[e])&&(t[e]=void 0),s)){var a=i&&("load"===i.type?"missing":i.type),n=i&&i.target&&i.target.src;o.message="Loading chunk "+e+" failed.\n("+a+": "+n+")",o.name="ChunkLoadError",o.type=a,o.request=n,s[1](o)}}),"chunk-"+e,e)}},r.O.j=e=>0===t[e];var e=(e,i)=>{var s,a,n=i[0],o=i[1],h=i[2],l=0;if(n.some((e=>0!==t[e]))){for(s in o)r.o(o,s)&&(r.m[s]=o[s]);if(h)var d=h(r)}for(e&&e(i);l<n.length;l++)a=n[l],r.o(t,a)&&t[a]&&t[a][0](),t[a]=0;return r.O(d)},i=self.webpackChunknextcloud=self.webpackChunknextcloud||[];i.forEach(e.bind(null,0)),i.push=e.bind(null,i.push.bind(i))})(),r.nc=void 0;var o=r.O(void 0,[7874],(()=>r(22509)));o=r.O(o)})();
//# sourceMappingURL=files_sharing-files_sharing_tab.js.map?v=b383551617ba7abca9f4